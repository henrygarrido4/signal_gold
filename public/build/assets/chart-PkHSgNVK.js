import{g as k}from"./getChartColorsArray-DXKIp7ac.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as z,A as F,r as u,c as B,w as g,o as M,a as v,h as N,f as S}from"./app-BWABJYdq.js";const Y={name:"CrmChart",props:{metrics:{type:Object,default:()=>({dailyMetrics:{}})},selectedPeriod:{type:Object,default:()=>({startDate:null,endDate:null})}},setup(d){const c=z([]),m=z({chart:{height:374,type:"line",toolbar:{show:!0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0},autoSelected:"zoom"},zoom:{enabled:!0,type:"x",autoScaleYaxis:!0,zoomedArea:{fill:{color:"#90CAF9",opacity:.4},stroke:{color:"#0D47A1",opacity:.4,width:1}}}},stroke:{curve:"smooth",dashArray:[0,3,0],width:[0,1,0]},fill:{opacity:[1,.1,1]},markers:{size:[0,4,0],strokeWidth:2,hover:{size:4}},grid:{show:!0,xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}},padding:{top:0,right:-2,bottom:15,left:10}},legend:{show:!0,horizontalAlign:"center",offsetX:0,offsetY:-5,markers:{width:9,height:9,radius:6},itemMargin:{horizontal:10,vertical:0}},plotOptions:{bar:{columnWidth:"30%",barHeight:"70%"}},colors:k('["--vz-primary", "--vz-secondary", "--vz-danger"]'),tooltip:{shared:!0,y:[{formatter:e=>(e==null?void 0:e.toFixed(0))??e},{formatter:e=>(e==null?void 0:e.toFixed(0))??e},{formatter:e=>(e==null?void 0:e.toFixed(0))??e}]}});return F(()=>[d.metrics.dailyMetrics,d.selectedPeriod],([e])=>{var b,C,w;if(!e)return;const D=(b=d.selectedPeriod)!=null&&b.startDate?new Date(d.selectedPeriod.startDate).getFullYear():new Date().getFullYear(),r=Object.entries(e).map(([,t])=>({date:new Date(D,t.monthDate-1,t.dayDate),metrics:t.metrics})).sort((t,o)=>t.date-o.date),x=(C=r[0])==null?void 0:C.date,f=(w=r[r.length-1])==null?void 0:w.date,_=f?Math.ceil((f-x)/(1e3*60*60*24)):0;let h=[],p=[],n=[],i=[];if(_>60&&r.length>60){const t=r.reduce((a,{date:s,metrics:y})=>{const l=`${s.getFullYear()}-${String(s.getMonth()).padStart(2,"0")}`,O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][s.getMonth()];return a[l]||(a[l]={displayKey:O,entries:0,delivered:0,leads:0,count:0,month:s.getMonth(),year:s.getFullYear()}),a[l].entries+=y.entries||0,a[l].delivered+=y.totalDelivered||0,a[l].leads+=y.totalLeads||0,a[l].count++,a},{}),o=Object.entries(t).sort(([a,s])=>a.localeCompare(s));h=o.map(([,a])=>a.displayKey),p=o.map(([,a])=>Math.round(a.entries)),n=o.map(([,a])=>Math.round(a.delivered)),i=o.map(([,a])=>Math.round(a.leads))}else h=r.map(t=>{const o=t.date.getMonth()+1,a=t.date.getDate();return`${o}/${a}`}),p=r.map(t=>t.metrics.entries||0),n=r.map(t=>t.metrics.totalDelivered||0),i=r.map(t=>Math.round(t.metrics.totalLeads||0));m.value={...m.value,chart:{...m.value.chart,id:"campaign-performance-chart"},xaxis:{categories:h,axisTicks:{show:!1},axisBorder:{show:!1},labels:{formatter:function(t){return t||""},style:{fontSize:"12px"},rotate:0},tickPlacement:"on"}},c.value=[{name:"Entries",type:"bar",data:p},{name:"Delivered",type:"area",data:n},{name:"Leads",type:"bar",data:i}]},{immediate:!0}),{series:c,chartOptions:m}}};function P(d,c,m,e,D,r){const x=u("BCardTitle"),f=u("BCardHeader"),_=u("apexchart"),h=u("BCardBody"),p=u("BCard");return M(),B(p,{"no-body":""},{default:g(()=>[v(f,{class:"border-0 align-items-center d-flex"},{default:g(()=>[v(x,{class:"mb-0 flex-grow-1"},{default:g(()=>c[0]||(c[0]=[N("Campaign Performance")])),_:1})]),_:1}),v(h,{class:"p-0 pb-2"},{default:g(()=>{var n,i;return[S("div",null,[(M(),B(_,{key:(i=(n=e.chartOptions)==null?void 0:n.xaxis)!=null&&i.categories?JSON.stringify(e.chartOptions.xaxis.categories):"chart",class:"apex-charts",height:"374",dir:"ltr",series:e.series,options:e.chartOptions},null,8,["series","options"]))])]}),_:1})]),_:1})}const $=A(Y,[["render",P]]);export{$ as default};
