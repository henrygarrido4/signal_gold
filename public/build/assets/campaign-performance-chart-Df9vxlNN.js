import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as u,c as x,w as f,o as p,a as y,h as S,d as g,f as o,t as _,F as D,g as b,n as B,D as v}from"./app-BWABJYdq.js";const w={props:{campaignAMetrics:{type:Object,default:()=>null},campaignBMetrics:{type:Object,default:()=>null},selectedCampaigns:{type:Array,required:!0}},computed:{isDateRangeValid(){var r,n,e,a;if(!((r=this.campaignAMetrics)!=null&&r.dailyMetrics)&&!((n=this.campaignBMetrics)!=null&&n.dailyMetrics))return!1;const t=Object.entries(((e=this.campaignAMetrics)==null?void 0:e.dailyMetrics)||{}).concat(Object.entries(((a=this.campaignBMetrics)==null?void 0:a.dailyMetrics)||{})).map(([l,i])=>{const[c,d]=[i.monthDate,i.dayDate];return new Date(2024,c-1,d)}).sort((l,i)=>l-i);return t.length?t[t.length-1].getMonth()-t[0].getMonth()+(t[t.length-1].getFullYear()-t[0].getFullYear())*12<=2:!1},chartData(){const t=this.groupMetricsByDate(this.campaignAMetrics),s=this.groupMetricsByDate(this.campaignBMetrics),r=[...new Set([...Object.keys(t),...Object.keys(s)])].sort(),n=(e,a,l)=>{var c;const i=Number(((c=e[a])==null?void 0:c[l])||0);return l==="leads"?Math.round(i):i};return{series:[{name:`${this.selectedCampaigns[0]||"Campaign A"} - Entries`,data:r.map(e=>n(t,e,"entries")),type:"bar"},{name:`${this.selectedCampaigns[0]||"Campaign A"} - Delivered`,data:r.map(e=>n(t,e,"delivered")),type:"bar"},{name:`${this.selectedCampaigns[0]||"Campaign A"} - Leads`,data:r.map(e=>n(t,e,"leads")),type:"bar"},{name:`${this.selectedCampaigns[1]||"Campaign B"} - Entries`,data:r.map(e=>n(s,e,"entries")),type:"bar"},{name:`${this.selectedCampaigns[1]||"Campaign B"} - Delivered`,data:r.map(e=>n(s,e,"delivered")),type:"bar"},{name:`${this.selectedCampaigns[1]||"Campaign B"} - Leads`,data:r.map(e=>n(s,e,"leads")),type:"bar"}],chartOptions:{chart:{type:"line",height:350,zoom:{enabled:!0,type:"x",autoScaleYaxis:!0},toolbar:{show:!0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!1,reset:!0},autoSelected:"zoom"}},colors:["#0ea5e9","#22c55e","#8b5cf6","#eab308","#ef4444","#f97316"],dataLabels:{enabled:!1},stroke:{width:0},markers:{size:0,strokeWidth:2,hover:{size:4}},xaxis:{categories:r,title:{text:"Date"},type:"datetime",labels:{formatter:function(e){return new Date(e).toLocaleString("default",{month:"short",day:"numeric"})},style:{fontSize:"12px"}}},yaxis:{title:{text:"Count"},labels:{formatter:e=>e?e.toLocaleString():"0"}},legend:{position:"top",horizontalAlign:"left",formatter:function(e,a){const[l,i]=e.split(" - ");return`<div class="legend-entry">${i}</div>`},customLegendItems:[],onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},tooltip:{x:{format:"dd MMM"}},fill:{opacity:1},plotOptions:{bar:{columnWidth:"30%",barHeight:"70%"}}}}}},methods:{toggleSeries(t){var s;this.chartData.series[t].show=!this.chartData.series[t].show,(s=this.$refs.chart)==null||s.updateSeries(this.chartData.series)},groupMetricsByDate(t){if(!(t!=null&&t.dailyMetrics))return{};const s={};return Object.entries(t.dailyMetrics).forEach(([r,n])=>{var l,i,c;const[e,a]=[n.monthDate,n.dayDate];if(e&&a){let d;if(r.includes("-"))d=r;else{const C=new Date().getFullYear();d=new Date(C,e-1,a).toISOString().split("T")[0]}s[d]={delivered:((l=n.metrics)==null?void 0:l.totalDelivered)||0,entries:((i=n.metrics)==null?void 0:i.entries)||0,leads:((c=n.metrics)==null?void 0:c.totalLeads)||0}}}),s}}},O={class:"d-flex justify-content-between mb-3"},z={class:"legend-column"},A={class:"mb-2"},j={class:"custom-legend"},L=["onClick"],V={class:"legend-text"},F={class:"legend-column"},I={class:"mb-2"},E={class:"custom-legend"},H=["onClick"],N={class:"legend-text"},T={key:1,class:"text-center py-4"};function Y(t,s,r,n,e,a){const l=u("BCardTitle"),i=u("BCardHeader"),c=u("apexchart"),d=u("BCardBody"),C=u("BCard");return p(),x(C,{"no-body":""},{default:f(()=>[y(i,null,{default:f(()=>[y(l,{class:"mb-0"},{default:f(()=>s[0]||(s[0]=[S("Campaign Performance")])),_:1})]),_:1}),y(d,null,{default:f(()=>[a.isDateRangeValid?(p(),g(D,{key:0},[o("div",O,[o("div",z,[o("h6",A,_(r.selectedCampaigns[0]||"Campaign A"),1),o("div",j,[(p(!0),g(D,null,b(a.chartData.series.slice(0,3),(h,m)=>(p(),g("div",{key:m,class:B(["legend-item",{active:h.show}]),onClick:M=>a.toggleSeries(m)},[o("span",{class:"legend-marker",style:v({backgroundColor:a.chartData.chartOptions.colors[m]})},null,4),o("span",V,_(h.name.split(" - ")[1]),1)],10,L))),128))])]),o("div",F,[o("h6",I,_(r.selectedCampaigns[1]||"Campaign B"),1),o("div",E,[(p(!0),g(D,null,b(a.chartData.series.slice(3,6),(h,m)=>(p(),g("div",{key:m+3,class:B(["legend-item",{active:h.show}]),onClick:M=>a.toggleSeries(m+3)},[o("span",{class:"legend-marker",style:v({backgroundColor:a.chartData.chartOptions.colors[m+3]})},null,4),o("span",N,_(h.name.split(" - ")[1]),1)],10,H))),128))])])]),y(c,{class:"apex-charts",height:"350",dir:"ltr",series:a.chartData.series,options:a.chartData.chartOptions},null,8,["series","options"])],64)):(p(),g("div",T,s[1]||(s[1]=[o("p",{class:"text-muted mb-0"}," Daily performance chart is only available for date ranges of 2 months or less. ",-1)])))]),_:1})]),_:1})}const R=k(w,[["render",Y],["__scopeId","data-v-dbfa3ea0"]]);export{R as default};
