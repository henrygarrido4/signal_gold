import{L as Q}from"./main-BZMVmuB9.js";import{P as Y}from"./page-header-CWp0LBfO.js";import q from"./gridjs-2Vc4inXu.js";import{T as R,B as U,r as f,I as z,c as B,w as c,o as C,a as m,f as i,d as M,g as A,t as k,k as L,h as g,l as H,e as T,F as N}from"./app-BWABJYdq.js";import{S as x}from"./sweetalert2.esm.all-CumHaNCI.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./simplebar-vue.esm-CZuBtKrH.js";import"./avatar-2-C9CWE8xV.js";import"./avatar-3-CcIxMpdW.js";import"./avatar-5-BPjc6EDL.js";import"./russia-pMTSjNGF.js";import"./logo-signal-9z7U6Iga.js";import"./logo-dark-BbIT5rJd.js";import"./logo-light-BfYujB8V.js";const X={yearly:{2023:{emails_sent:12e4,emails_opened:84e3,clicks:25200,entries:18900,leads:3780,click_rate:30,conversion_rate:20},2024:{emails_sent:15e4,emails_opened:105e3,clicks:31500,entries:23625,leads:4725,click_rate:35,conversion_rate:25}},quarterly:{"Q1 2024":{emails_sent:37500,emails_opened:26250,clicks:7875,entries:5906,leads:1181,click_rate:33,conversion_rate:22},"Q4 2023":{emails_sent:35e3,emails_opened:24500,clicks:7350,entries:5512,leads:1102,click_rate:31,conversion_rate:21},"Q3 2023":{emails_sent:32500,emails_opened:22750,clicks:6825,entries:5118,leads:1023,click_rate:29,conversion_rate:19}},monthly:{"Jan 2024":{emails_sent:12500,emails_opened:8750,clicks:2625,entries:1968,leads:393,click_rate:34,conversion_rate:23},"Dec 2023":{emails_sent:11800,emails_opened:8260,clicks:2478,entries:1858,leads:371,click_rate:32,conversion_rate:22},"Nov 2023":{emails_sent:11200,emails_opened:7840,clicks:2352,entries:1764,leads:352,click_rate:30,conversion_rate:21}},weekly:{"Week 1 Jan 2024":{emails_sent:3125,emails_opened:2187,clicks:656,entries:492,leads:98,click_rate:35,conversion_rate:24},"Week 4 Dec 2023":{emails_sent:2950,emails_opened:2065,clicks:619,entries:464,leads:92,click_rate:33,conversion_rate:23},"Week 3 Dec 2023":{emails_sent:2800,emails_opened:1960,clicks:588,entries:441,leads:88,click_rate:31,conversion_rate:22}}},Z={components:{Layout:Q,PageHeader:Y,GridJs:q},props:{snapshots:{type:Array,default:()=>[]}},data(){return{selectedComparison:"daily",comparisonPeriods:[{value:"wow",label:"WoW"},{value:"mom",label:"MoM"},{value:"qoq",label:"QoQ"},{value:"yoy",label:"YoY"}],selectedSnapshot:null,comparisonSnapshot:null,showComparison:!1,searchQuery:"",showEditModal:!1,form:R({name:"",notes:""}),editForm:{id:null},showDeleteModal:!1,snapshotToDelete:null,isDeleting:!1,monthOrder:{January:1,February:2,March:3,April:4,May:5,June:6,July:7,August:8,September:9,October:10,November:11,December:12},sortColumn:null,sortDirection:"asc"}},created(){},watch:{selectedSnapshot(s){s||(this.selectedComparison="daily"),this.showComparison=!1,this.comparisonSnapshot=null},searchQuery(s){},showComparison(s){s||(this.comparisonSnapshot=null)},comparisonSnapshot:{handler(s){},deep:!0}},computed:{filteredSnapshots(){let s=this.snapshots||[];if(this.searchQuery){const e=this.searchQuery.toLowerCase().trim();s=s.filter(o=>o.name&&o.name.toLowerCase().includes(e)||o.campaign_name&&o.campaign_name.toLowerCase().includes(e)||o.notes&&o.notes.toLowerCase().includes(e)||o.period_type&&o.period_type.toLowerCase().includes(e))}return s},periodData(){if(!this.selectedSnapshot)return[];const s=X[this.selectedSnapshot.period_type]||{},e=Object.keys(s).sort((r,t)=>new Date(t)-new Date(r)),o={};return e.forEach(r=>{this.shouldIncludePeriod(r)&&(o[r]=s[r])}),o},gridData(){return this.formatGridData()},sortedGridData(){if(!this.gridData.length)return[];const s=[...this.gridData];return this.sortColumn?s.sort((e,o)=>{let r=e[this.sortColumn],t=o[this.sortColumn];if(this.sortColumn==="period"){const n=a=>{if(a.includes("-")){const l=a.split("-")[0].trim(),u=["January","February","March","April","May","June","July","August","September","October","November","December"].findIndex(y=>l.includes(y)),_=l.match(/\d+/);if(u!==-1&&_)return(u+1)*100+parseInt(_[0])}else if(a.includes("/")){const[l,h]=a.split("/").map(Number);return l*100+h}else{const h=["January","February","March","April","May","June","July","August","September","October","November","December"].findIndex(u=>a===u);if(h!==-1)return(h+1)*100}return 0};r=n(r),t=n(t)}return["delivered","email_click_thru","entries","leads"].includes(this.sortColumn)&&(r=parseFloat(r)||0,t=parseFloat(t)||0),["click_thru_rate","conversion_rate"].includes(this.sortColumn)&&(r=parseFloat(r.replace("%",""))||0,t=parseFloat(t.replace("%",""))||0),this.sortDirection==="asc"?r>t?1:-1:r<t?1:-1}):s},combinedGridData(){var r,t,n,a;if(!this.showComparison||!this.comparisonSnapshot)return this.sortedGridData;const s=((t=(r=this.selectedSnapshot)==null?void 0:r.metrics_data)==null?void 0:t.dailyMetrics)||{},e=((a=(n=this.comparisonSnapshot)==null?void 0:n.metrics_data)==null?void 0:a.dailyMetrics)||{};let o=[];switch(this.selectedComparison){case"daily":const l=this.aggregateByDay(s),h=this.aggregateByDay(e);o=this.combineMetrics(l,h);break;case"weekly":const u=this.aggregateByWeek(s),_=this.aggregateByWeek(e);o=this.combineMetrics(u,_);break;case"monthly":const y=this.aggregateByMonth(s),D=this.aggregateByMonth(e);o=this.combineMetrics(y,D);break;case"yearly":const b=this.aggregateByYear(s),w=this.aggregateByYear(e);o=this.combineMetrics(b,w);break}return o}},methods:{formatNumber(s){return new Intl.NumberFormat().format(s||0)},formatPercentage(s){return(s||0).toFixed(2)},formatDate(s){return new Date(s).toLocaleDateString()},getPercentageClass(s){return s?s>=75?"success":s>=50?"primary":s>=25?"warning":"danger":"secondary"},getPeriodVariant(s){return{daily:"info",weekly:"primary",monthly:"success",quarterly:"warning",yearly:"danger"}[s]||"secondary"},getSnapshotVariant(s){return{daily:"primary",weekly:"success",monthly:"info",quarterly:"warning",yearly:"danger"}[s.period_type]||"secondary"},exportData(){if(!this.selectedSnapshot)return;const s=this.showComparison?this.combinedGridData:this.formatGridData();let e="";const r=[this.getPeriodLabel(this.selectedComparison),this.showComparison?"Delivered (A vs B)":"Delivered",this.showComparison?"Email Click-Thru (A vs B)":"Email Click-Thru",this.showComparison?"Click-Thru Rate % (A vs B)":"Click-Thru Rate (%)",this.showComparison?"Entries (A vs B)":"Entries",this.showComparison?"Leads (A vs B)":"Leads",this.showComparison?"Conversion Rate % (A vs B)":"Conversion Rate (%)","Trend Status","Trend Details"];e+=r.join(",")+`
`,s.forEach(u=>{var b,w,v;const _=((b=u.trend)==null?void 0:b.status)||"n/a",y=((v=(w=u.trend)==null?void 0:w.details)==null?void 0:v.replace(/,/g,";"))||"n/a",D=[u.period,u.delivered,u.email_click_thru,u.click_thru_rate,u.entries,u.leads,u.conversion_rate,_,y];e+=D.join(",")+`
`});const t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(t),l=new Date().toISOString().split("T")[0],h=`${this.selectedSnapshot.name}_${this.selectedComparison}_metrics_${l}.csv`;n.setAttribute("href",a),n.setAttribute("download",h),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},getPeriodLabel(s){return{daily:"Date",weekly:"Week",monthly:"Month",yearly:"Year"}[s]||"Period"},selectSnapshot(s){this.showComparison=!1,this.comparisonSnapshot=null,this.selectedSnapshot=s},confirmDelete(s){x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(e=>{e.isConfirmed&&this.handleDelete(s)})},showSuccessAlert(s){x.fire({title:"Success!",text:s,icon:"success",showConfirmButton:!1,timer:1500,timerProgressBar:!0})},showErrorAlert(s){x.fire({title:"Error!",text:s,icon:"error",confirmButtonColor:"#34c38f",confirmButtonText:"Ok"})},async handleDelete(s){var e,o;try{await U.delete(route("campaign-snapshots.destroy",s.id),{preserveScroll:!0,onSuccess:()=>{var r;this.showSuccessAlert("Snapshot deleted successfully"),((r=this.selectedSnapshot)==null?void 0:r.id)===s.id&&(this.selectedSnapshot=null)},onError:r=>{console.error("Error deleting snapshot:",r),this.showErrorAlert(r.message||"Failed to delete snapshot")}})}catch(r){console.error("Error deleting snapshot:",r),this.showErrorAlert(((o=(e=r.response)==null?void 0:e.data)==null?void 0:o.message)||"Failed to delete snapshot")}},getComparisonLabel(s){switch(s){case"wow":return"Week over Week";case"mom":return"Month over Month";case"qoq":return"Quarter over Quarter";case"yoy":return"Year over Year";default:return"All Periods"}},shouldIncludePeriod(s){switch(this.selectedComparison){case"wow":return s.includes("Week");case"mom":return!s.includes("Week")&&!s.includes("Q");case"qoq":return s.includes("Q");case"yoy":return s.length===4;default:return!0}},calculateTrend(s,e){if(!e)return{status:"neutral",details:"No previous data for comparison"};const o=(a,l)=>l?(a-l)/l*100:0,r={clicks:o(s.email_click_thru,e.email_click_thru),conversion:o(s.leads/s.entries*100,e.leads/e.entries*100),leads:o(s.leads,e.leads),entries:o(s.entries,e.entries)},t=r.leads*.3+r.conversion*.25+r.entries*.25+r.clicks*.2,n=[`Leads: ${r.leads.toFixed(1)}%`,`Entries: ${r.entries.toFixed(1)}%`,`Conversion: ${r.conversion.toFixed(1)}%`,`Clicks: ${r.clicks.toFixed(1)}%`].join(" | ");return t>5?{status:"up",details:n}:t<-5?{status:"down",details:n}:{status:"neutral",details:`Small changes (${t.toFixed(1)}%) | ${n}`}},formatTrend(s){return s?`
        <div class="d-flex align-items-center">
          <span class="me-2">${{up:'<i class="ri-arrow-up-line text-success"></i>',down:'<i class="ri-arrow-down-line text-danger"></i>',neutral:'<i class="ri-minus-line text-warning"></i>'}[s.status]}</span>
          <span class="small text-muted me-2">
            ${s.status==="neutral"?"No significant change":s.status==="up"?"Improved":"Declined"}
          </span>
          <i class="ri-information-line text-muted cursor-pointer" 
             v-b-tooltip.hover.left 
             title="${s.details}">
          </i>
        </div>
      `:""},editSnapshot(s){this.form.name=s.name,this.form.notes=s.notes||"",this.editForm.id=s.id,this.showEditModal=!0},async updateSnapshot(){this.form.put(route("campaign-snapshots.update",this.editForm.id),{preserveScroll:!0,onSuccess:()=>{this.showEditModal=!1,this.resetEditForm()},onError:()=>{console.error("Failed to update snapshot")}})},resetEditForm(){this.form.reset(),this.editForm.id=null},aggregateByDay(s){return Object.entries(s).map(([e,o])=>{const r=o.metrics;return{period:`${o.monthDate}/${o.dayDate}`,delivered:r.totalDelivered||0,email_click_thru:r.totalClicks||0,click_thru_rate:this.formatPercentage(r.clickThruRate*100),entries:r.entries||0,leads:Math.round(r.totalLeads||0),conversion_rate:this.formatPercentage(r.conversion*100)}}).sort((e,o)=>{const[r,t]=e.period.split("/").map(Number),[n,a]=o.period.split("/").map(Number);return n===r?a-t:n-r})},aggregateByMonth(s){const e={};Object.entries(s).forEach(([r,t])=>{const n=t.monthDate;e[n]||(e[n]={delivered:0,clicks:0,entries:0,leads:0});const a=t.metrics;e[n].delivered+=a.totalDelivered||0,e[n].clicks+=a.totalClicks||0,e[n].entries+=a.entries||0,e[n].leads+=a.totalLeads||0});const o=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.entries(e).map(([r,t])=>({period:o[Number(r)-1],delivered:Math.round(t.delivered),email_click_thru:Math.round(t.clicks),click_thru_rate:this.formatPercentage(t.clicks/t.delivered*100),entries:Math.round(t.entries),leads:Math.round(t.leads),conversion_rate:this.formatPercentage(t.leads/t.entries*100)})).sort((r,t)=>this.monthOrder[t.period]-this.monthOrder[r.period])},aggregateByYear(s){const e={delivered:0,clicks:0,entries:0,leads:0};return Object.entries(s).forEach(([o,r])=>{const t=r.metrics;e.delivered+=t.totalDelivered||0,e.clicks+=t.totalClicks||0,e.entries+=t.entries||0,e.leads+=t.totalLeads||0}),[{period:"2025",delivered:Math.round(e.delivered),email_click_thru:Math.round(e.clicks),click_thru_rate:this.formatPercentage(e.clicks/e.delivered*100),entries:Math.round(e.entries),leads:Math.round(e.leads),conversion_rate:this.formatPercentage(e.leads/e.entries*100)}]},aggregateByWeek(s){const e={},o=Object.entries(s).sort(([,n],[,a])=>{const l=new Date(2025,n.monthDate-1,n.dayDate),h=new Date(2025,a.monthDate-1,a.dayDate);return l-h});let r=null,t=null;return o.forEach(([n,a],l)=>{const h=new Date(2025,a.monthDate-1,a.dayDate),u=h.getDay();if(!r||h>t||l>0&&h-new Date(2025,o[l-1][1].monthDate-1,o[l-1][1].dayDate)>24*60*60*1e3){if(r=new Date(h),t=new Date(h),l===0&&u!==1)t.setDate(t.getDate()+(7-u));else{const b=u===0?0:7-u;t.setDate(t.getDate()+b)}const D=new Date(2025,o[o.length-1][1].monthDate-1,o[o.length-1][1].dayDate);t>D&&(t=new Date(D))}const _=this.formatDateRange(r,t);e[_]||(e[_]={startDate:r,delivered:0,clicks:0,entries:0,leads:0});const y=a.metrics;e[_].delivered+=y.totalDelivered||0,e[_].clicks+=y.totalClicks||0,e[_].entries+=y.entries||0,e[_].leads+=y.totalLeads||0}),Object.entries(e).map(([n,a])=>({period:n,delivered:Math.round(a.delivered),email_click_thru:Math.round(a.clicks),click_thru_rate:this.formatPercentage(a.clicks/a.delivered*100),entries:Math.round(a.entries),leads:Math.round(a.leads),conversion_rate:this.formatPercentage(a.leads/a.entries*100)})).sort((n,a)=>{const l=new Date(e[n.period].startDate);return new Date(e[a.period].startDate)-l})},formatDateRange(s,e){const o=["January","February","March","April","May","June","July","August","September","October","November","December"];return s.getMonth()===e.getMonth()?`${o[s.getMonth()]} ${s.getDate()}-${e.getDate()}`:`${o[s.getMonth()]} ${s.getDate()}-${o[e.getMonth()]} ${e.getDate()}`},formatGridData(s=null){var o;const e=s||this.selectedSnapshot;if(!((o=e==null?void 0:e.metrics_data)!=null&&o.dailyMetrics))return[];try{const r=e.metrics_data.dailyMetrics;let t;switch(this.selectedComparison){case"daily":t=this.aggregateByDay(r);break;case"weekly":t=this.aggregateByWeek(r);break;case"monthly":t=this.aggregateByMonth(r);break;case"yearly":t=this.aggregateByYear(r);break;default:t=[]}return t.map((n,a)=>({...n,trend:this.calculateTrend(n,a<t.length-1?t[a+1]:null)}))}catch(r){return console.error("Error formatting grid data:",r),[]}},handleSort({column:s,direction:e}){this.sortColumn=s,this.sortDirection=e},compareSnapshots(s,e){const o=(a,l)=>(a=parseFloat(String(a).replace(/[^0-9.-]+/g,"")),l=parseFloat(String(l).replace(/[^0-9.-]+/g,"")),((a-l)/l*100).toFixed(1)),r={delivered:o(s.delivered,e.delivered),clicks:o(s.email_click_thru,e.email_click_thru),entries:o(s.entries,e.entries),leads:o(s.leads,e.leads),conversion:o(parseFloat(s.conversion_rate),parseFloat(e.conversion_rate))},t=[`Delivered: ${r.delivered}%`,`Clicks: ${r.clicks}%`,`Entries: ${r.entries}%`,`Leads: ${r.leads}%`,`Conversion: ${r.conversion}%`].join(" | "),n=Object.values(r).reduce((a,l)=>a+parseFloat(l),0)/5;return{status:n>0?"up":n<0?"down":"neutral",details:t}},combineMetrics(s,e){if(!s.length||!e.length)return[];const o=new Set([...s.map(r=>r.period),...e.map(r=>r.period)]);return Array.from(o).map(r=>{const t=s.find(a=>a.period===r),n=e.find(a=>a.period===r);return t&&n?{period:r,delivered:`${t.delivered||0} vs ${n.delivered||0}`,email_click_thru:`${t.email_click_thru||0} vs ${n.email_click_thru||0}`,click_thru_rate:`${t.click_thru_rate||0}% vs ${n.click_thru_rate||0}%`,entries:`${t.entries||0} vs ${n.entries||0}`,leads:`${t.leads||0} vs ${n.leads||0}`,conversion_rate:`${t.conversion_rate||0}% vs ${n.conversion_rate||0}%`,trend:this.compareSnapshots(t,n)}:t?{...t,trend:{status:"neutral",details:"No comparison data available"}}:n?{period:r,delivered:`- vs ${n.delivered||0}`,email_click_thru:`- vs ${n.email_click_thru||0}`,click_thru_rate:`- vs ${n.click_thru_rate||0}%`,entries:`- vs ${n.entries||0}`,leads:`- vs ${n.leads||0}`,conversion_rate:`- vs ${n.conversion_rate||0}%`,trend:{status:"neutral",details:"Data only available in comparison snapshot"}}:null}).filter(Boolean).sort((r,t)=>new Date(t.period)-new Date(r.period))},handleComparisonChange(s){if(s){const e=this.snapshots.find(o=>o.id===s);e&&(this.comparisonSnapshot=e)}else this.comparisonSnapshot=null}}},$={class:"d-flex w-100 justify-content-between"},ee={class:"mb-1"},te={class:"mb-1"},se={key:0,class:"ms-2"},re=["title"],ne={class:"ms-2 text-muted"},oe={class:"d-flex align-items-center mb-4"},ae={class:"card-title flex-grow-1 mb-0"},ie={class:"text-muted ms-2"},le={class:"flex-shrink-0 d-flex gap-2"},ce={class:"d-flex align-items-center mb-3 text-muted"},de={class:"fw-medium"},me={key:1,class:"text-center mt-5"},ue={class:"d-flex justify-content-end gap-2 pt-3"},he={class:"d-flex justify-content-center gap-2"};function pe(s,e,o,r,t,n){const a=f("PageHeader"),l=f("BFormInput"),h=f("BDropdownItem"),u=f("BDropdown"),_=f("BListGroupItem"),y=f("BListGroup"),D=f("BCardBody"),b=f("BCard"),w=f("BCol"),v=f("BButton"),P=f("BFormSelect"),V=f("BButtonGroup"),G=f("GridJs"),J=f("BRow"),F=f("BFormGroup"),O=f("BFormTextarea"),W=f("BForm"),E=f("BModal"),I=f("Layout"),j=z("b-tooltip");return C(),B(I,null,{default:c(()=>[m(a,{title:"Campaign Snapshots",pageTitle:"CRM"}),m(J,null,{default:c(()=>[m(w,{md:"4",xl:"3"},{default:c(()=>[m(b,null,{default:c(()=>[m(D,null,{default:c(()=>[e[15]||(e[15]=i("div",{class:"d-flex align-items-center mb-4"},[i("h5",{class:"card-title flex-grow-1 mb-0"},"Saved Snapshots")],-1)),m(l,{modelValue:t.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=d=>t.searchQuery=d),modelModifiers:{trim:!0},placeholder:"Search snapshots...",class:"mb-3",size:"sm",debounce:"300",autocomplete:"off",onInput:e[1]||(e[1]=d=>t.searchQuery=d.trim())},{prepend:c(()=>e[11]||(e[11]=[i("div",{class:"input-group-text"},[i("i",{class:"ri-search-line"})],-1)])),_:1},8,["modelValue"]),m(y,null,{default:c(()=>[(C(!0),M(N,null,A(n.filteredSnapshots,d=>{var p;return C(),B(_,{key:d.id,href:"#",class:"list-group-item-action",variant:"light",active:((p=t.selectedSnapshot)==null?void 0:p.id)===d.id,onClick:S=>n.selectSnapshot(d)},{default:c(()=>[i("div",$,[i("h6",ee,k(d.name),1),m(u,{variant:"link","no-caret":"",right:"","toggle-class":"text-decoration-none p-0",onClick:e[2]||(e[2]=L(()=>{},["stop"]))},{"button-content":c(()=>e[12]||(e[12]=[i("i",{class:"ri-more-2-fill"},null,-1)])),default:c(()=>[m(h,{onClick:S=>n.editSnapshot(d)},{default:c(()=>e[13]||(e[13]=[i("i",{class:"ri-edit-line me-2"},null,-1),g(" Edit ")])),_:2},1032,["onClick"]),m(h,{onClick:S=>n.confirmDelete(d),variant:"danger",disabled:t.isDeleting},{default:c(()=>[e[14]||(e[14]=i("i",{class:"ri-delete-bin-line me-2"},null,-1)),g(" "+k(t.isDeleting?"Deleting...":"Delete"),1)]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),i("p",te,k(d.campaign_name),1),i("small",null,[d.notes?(C(),M("span",se,[H(i("i",{class:"ri-information-line",title:d.notes},null,8,re),[[j]])])):T("",!0),i("small",ne,k(n.formatDate(d.created_at)),1)])]),_:2},1032,["variant","active","onClick"])}),128))]),_:1})]),_:1})]),_:1})]),_:1}),m(w,{md:"8",xl:"9"},{default:c(()=>[t.selectedSnapshot?(C(),B(b,{key:0},{default:c(()=>[m(D,null,{default:c(()=>{var d;return[i("div",oe,[i("h5",ae,[g(k(t.selectedSnapshot.name)+" ",1),i("small",ie," Saved on "+k(n.formatDate(t.selectedSnapshot.created_at)),1)]),i("div",le,[m(v,{variant:"outline-primary",size:"sm",onClick:e[3]||(e[3]=p=>t.showComparison=!t.showComparison),pressed:t.showComparison},{default:c(()=>e[16]||(e[16]=[i("i",{class:"ri-git-compare-line"},null,-1),g(" Compare ")])),_:1},8,["pressed"]),t.showComparison?(C(),B(P,{key:0,"model-value":(d=t.comparisonSnapshot)==null?void 0:d.id,options:n.filteredSnapshots.filter(p=>{var S;return p.id!==((S=t.selectedSnapshot)==null?void 0:S.id)}).map(p=>({value:p.id,text:p.name})),size:"sm",class:"w-auto",onChange:n.handleComparisonChange},{first:c(()=>e[17]||(e[17]=[i("option",{value:null},"Select snapshot to compare",-1)])),_:1},8,["model-value","options","onChange"])):T("",!0),m(V,{size:"sm"},{default:c(()=>[(C(),M(N,null,A(["daily","weekly","monthly","yearly"],p=>m(v,{key:p,variant:t.selectedComparison===p?"primary":"outline-primary",onClick:S=>t.selectedComparison=p},{default:c(()=>[g(k(p.charAt(0).toUpperCase()+p.slice(1)),1)]),_:2},1032,["variant","onClick"])),64))]),_:1}),m(v,{variant:"soft-primary",size:"sm",onClick:n.exportData},{default:c(()=>e[18]||(e[18]=[i("i",{class:"ri-file-download-line align-bottom"},null,-1),g(" Export ")])),_:1},8,["onClick"])])]),i("div",ce,[i("small",null,[e[19]||(e[19]=g(" Comparing: ")),i("span",de,k(n.getComparisonLabel(t.selectedComparison))+" (Note: For accurate trend analysis, data must be in descending date order) ",1)])]),m(G,{data:t.showComparison?n.combinedGridData:n.sortedGridData,columns:[{name:n.getPeriodLabel(t.selectedComparison),id:"period"},{name:t.showComparison?"Delivered (A vs B)":"Delivered",id:"delivered"},{name:t.showComparison?"Email Click-Thru (A vs B)":"Email Click-Thru",id:"email_click_thru"},{name:t.showComparison?"Click-Thru Rate % (A vs B)":"Click-Thru Rate (%)",id:"click_thru_rate",formatter:p=>`${p}%`},{name:t.showComparison?"Entries (A vs B)":"Entries",id:"entries"},{name:t.showComparison?"Leads (A vs B)":"Leads",id:"leads"},{name:t.showComparison?"Conv. Rate % (A vs B)":"Conversion Rate (%)",id:"conversion_rate",formatter:p=>`${p}%`},{name:"Trend",id:"trend",formatter:p=>this.formatTrend(p)}],search:!0,sort:!0,pagination:!0,onSort:n.handleSort},null,8,["data","columns","onSort"]),e[20]||(e[20]=i("div",{class:"mt-4"},[i("h6",{class:"mb-3"},"Performance Trend")],-1))]}),_:1})]),_:1})):(C(),M("div",me,e[21]||(e[21]=[i("i",{class:"ri-file-list-3-line display-4 text-muted"},null,-1),i("p",{class:"mt-2"},"Select a snapshot to view details",-1)])))]),_:1})]),_:1}),m(E,{modelValue:t.showEditModal,"onUpdate:modelValue":e[7]||(e[7]=d=>t.showEditModal=d),title:"Edit Snapshot",onHidden:n.resetEditForm,"hide-footer":""},{default:c(()=>[m(W,{onSubmit:L(n.updateSnapshot,["prevent"])},{default:c(()=>[m(F,{label:"Name","label-for":"snapshot-name"},{default:c(()=>[m(l,{id:"snapshot-name",modelValue:t.form.name,"onUpdate:modelValue":e[4]||(e[4]=d=>t.form.name=d),required:""},null,8,["modelValue"])]),_:1}),m(F,{label:"Notes","label-for":"snapshot-notes"},{default:c(()=>[m(O,{id:"snapshot-notes",modelValue:t.form.notes,"onUpdate:modelValue":e[5]||(e[5]=d=>t.form.notes=d),rows:"3"},null,8,["modelValue"])]),_:1}),i("div",ue,[m(v,{variant:"secondary",onClick:e[6]||(e[6]=d=>t.showEditModal=!1),disabled:t.form.processing},{default:c(()=>e[22]||(e[22]=[g(" Cancel ")])),_:1},8,["disabled"]),m(v,{type:"submit",variant:"primary",disabled:t.form.processing},{default:c(()=>[g(k(t.form.processing?"Saving...":"Save Changes"),1)]),_:1},8,["disabled"])])]),_:1},8,["onSubmit"])]),_:1},8,["modelValue","onHidden"]),m(E,{modelValue:t.showDeleteModal,"onUpdate:modelValue":e[10]||(e[10]=d=>t.showDeleteModal=d),title:"Confirm Delete","hide-footer":"",centered:""},{default:c(()=>[e[24]||(e[24]=i("div",{class:"text-center mb-4"},[i("i",{class:"ri-error-warning-line text-danger display-4 mb-3"}),i("h5",null,"Are you sure?"),i("p",{class:"text-muted"}," Do you really want to delete this snapshot? This process cannot be undone. ")],-1)),i("div",he,[m(v,{variant:"secondary",onClick:e[8]||(e[8]=d=>t.showDeleteModal=!1),disabled:t.isDeleting},{default:c(()=>e[23]||(e[23]=[g(" Cancel ")])),_:1},8,["disabled"]),m(v,{variant:"danger",onClick:e[9]||(e[9]=d=>n.handleDelete(t.snapshotToDelete)),disabled:t.isDeleting},{default:c(()=>[g(k(t.isDeleting?"Deleting...":"Delete"),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]),_:1})}const Fe=K(Z,[["render",pe],["__scopeId","data-v-e67414de"]]);export{Fe as default};
