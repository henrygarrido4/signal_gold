import{o as i,d as a,f as t,t as m,r as g,l as M,J as P,a as n,w as l,h as u,e as v,F as k,g as F,k as C,Z as tt,j as et,B as R,n as T,c as I}from"./app-BWABJYdq.js";import{L as st}from"./main-BZMVmuB9.js";import{P as lt}from"./page-header-CWp0LBfO.js";import{h as it}from"./moment-C5S46NFB.js";import{S as E}from"./sweetalert2.esm.all-CumHaNCI.js";import{s as nt}from"./simplebar-vue.esm-CZuBtKrH.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./avatar-2-C9CWE8xV.js";import"./avatar-3-CcIxMpdW.js";import"./avatar-5-BPjc6EDL.js";import"./russia-pMTSjNGF.js";import"./logo-signal-9z7U6Iga.js";import"./logo-dark-BbIT5rJd.js";import"./logo-light-BfYujB8V.js";const ot={props:{attachment:{type:Object,required:!0}},computed:{isImage(){var s;return(s=this.attachment.type)==null?void 0:s.startsWith("image/")},previewUrl(){return this.attachment.url?this.attachment.url:route("comments.attachment.download",this.attachment.id)},downloadUrl(){return this.attachment.url?this.attachment.url:route("comments.attachment.download",this.attachment.id)}},methods:{formatFileSize(s){if(s===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,b)).toFixed(2))+" "+o[b]},showFullImage(){this.isImage&&this.$emit("preview",this.attachment)}}},at={class:"d-flex align-items-center gap-2 bg-light p-2 rounded mb-1"},rt={key:0,class:"position-relative"},dt=["src","alt"],ct={key:1,class:"ri-file-text-line"},mt=["href","target","download"],ut={class:"text-muted small"};function ft(s,e,o,b,d,r){return i(),a("div",at,[r.isImage?(i(),a("div",rt,[t("img",{src:r.previewUrl,class:"attachment-thumbnail cursor-pointer",onClick:e[0]||(e[0]=(...x)=>r.showFullImage&&r.showFullImage(...x)),alt:o.attachment.name},null,8,dt)])):(i(),a("i",ct)),t("a",{href:r.downloadUrl,class:"text-reset text-decoration-none flex-grow-1 text-truncate",target:r.isImage?"_blank":void 0,download:o.attachment.name},m(o.attachment.name),9,mt),t("span",ut,m(r.formatFileSize(o.attachment.size)),1)])}const _t=W(ot,[["render",ft],["__scopeId","data-v-346422d6"]]),ht={props:{processing:Boolean,parentId:{type:Number,default:null}},data(){return{content:"",attachments:[]}},methods:{handleFileAttachment(s){const o=Array.from(s.target.files).filter(b=>b.size>10485760?(this.$bvToast.toast(`File ${b.name} exceeds 10MB limit`,{title:"File too large",variant:"warning"}),!1):!0);this.attachments=[...this.attachments||[],...o]},removeAttachment(s){this.attachments.splice(s,1)},formatFileSize(s){if(s===0)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,b)).toFixed(2))+" "+o[b]},submitForm(){if(this.content.trim())try{const s=new FormData;s.append("content",this.content.trim()),this.parentId&&s.append("parent_id",String(this.parentId)),this.attachments&&this.attachments.length>0&&this.attachments.forEach((e,o)=>{s.append(`attachments[${o}]`,e)}),this.$emit("submit",s),this.content="",this.attachments=[],this.$refs.fileInput&&(this.$refs.fileInput.value="")}catch(s){console.error("Error creating form data:",s)}}}},pt={class:"row"},gt={class:"col"},vt={class:"row mt-2"},bt={class:"col d-flex align-items-center gap-2"},xt={key:0,class:"text-muted small"},yt={class:"col-auto"},kt={key:0,class:"row mt-2"},wt={class:"col"},Ct={class:"border rounded p-2"},Ft={class:"text-truncate"},Bt={class:"text-muted small"};function jt(s,e,o,b,d,r){var S,B;const x=g("BButton");return i(),a("form",{onSubmit:e[3]||(e[3]=C((...w)=>r.submitForm&&r.submitForm(...w),["prevent"]))},[t("div",pt,[t("div",gt,[M(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=w=>d.content=w),class:"form-control",rows:"3",placeholder:"Leave a comment..."},null,512),[[P,d.content]])])]),t("div",vt,[t("div",bt,[t("input",{type:"file",ref:"fileInput",class:"d-none",onChange:e[1]||(e[1]=(...w)=>r.handleFileAttachment&&r.handleFileAttachment(...w)),multiple:"",accept:".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.xls,.xlsx,.txt"},null,544),n(x,{type:"button",variant:"light",size:"sm",onClick:e[2]||(e[2]=w=>s.$refs.fileInput.click())},{default:l(()=>e[4]||(e[4]=[t("i",{class:"ri-attachment-2 me-1"},null,-1),u(" Attach Files ")])),_:1}),(S=d.attachments)!=null&&S.length?(i(),a("div",xt,m(d.attachments.length)+" file(s) selected ",1)):v("",!0)]),t("div",yt,[n(x,{type:"submit",variant:"primary",disabled:!d.content||o.processing},{default:l(()=>e[5]||(e[5]=[u(" Post Comment ")])),_:1},8,["disabled"])])]),(B=d.attachments)!=null&&B.length?(i(),a("div",kt,[t("div",wt,[t("div",Ct,[(i(!0),a(k,null,F(d.attachments,(w,j)=>(i(),a("div",{key:j,class:"d-flex align-items-center gap-2 mb-1 last:mb-0"},[e[7]||(e[7]=t("i",{class:"ri-file-text-line"},null,-1)),t("span",Ft,m(w.name),1),t("span",Bt," ("+m(r.formatFileSize(w.size))+") ",1),n(x,{variant:"link",size:"sm",class:"text-danger p-0 ms-auto",onClick:D=>r.removeAttachment(j)},{default:l(()=>e[6]||(e[6]=[t("i",{class:"ri-close-line"},null,-1)])),_:2},1032,["onClick"])]))),128))])])])):v("",!0)],32)}const St=W(ht,[["render",jt]]),Dt={props:{project:{type:Object,required:!0}},components:{Layout:st,PageHeader:lt,Head:tt,Link:et,Simplebar:nt,CommentAttachment:_t,CommentForm:St},data(){return{showFullDescription:!1,showFilePreview:!1,selectedFile:null,errors:{},form:{content:"",parent_id:null,processing:!1,attachments:[]},editingComment:null,replyingTo:null,replyForm:{content:""},showImagePreview:!1,previewImage:null,acceptedFileTypes:".pdf,.doc,.docx,.xls,.xlsx,.txt,.jpg,.jpeg,.png,.gif"}},computed:{truncatedDescription(){return this.project.description.length<=629?this.project.description:this.project.description.substring(0,629)+"..."}},methods:{formatDate(s){return it(s).fromNow()},viewFile(s){["image/jpeg","image/png","image/gif","application/pdf","text/plain"].includes(s.type)?(this.selectedFile=s,this.showFilePreview=!0):window.open(s.url,"_blank")},deleteFile(s){E.fire({title:"Are you sure?",text:`You want to delete ${s.name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",showCloseButton:!0}).then(e=>{e.isConfirmed&&R.delete(route("projects.delete-file",{project:this.project.id,filename:encodeURIComponent(s.name)}),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{E.fire({title:"Deleted!",text:"File has been deleted successfully.",icon:"success",showConfirmButton:!1,timer:1500,timerProgressBar:!0})},onError:o=>{E.fire({title:"Error!",text:(o==null?void 0:o.message)||"Failed to delete file.",icon:"error",confirmButtonColor:"#34c38f",confirmButtonText:"Ok"})}})})},handleFileUpload(s){const e=s.target.files;if(!e.length)return;const o=e[0],b=2*1024*1024;if(o.size>b){E.fire({title:"Error!",text:`File ${o.name} exceeds the 2MB size limit`,icon:"error",confirmButtonColor:"#34c38f",confirmButtonText:"Ok"}),s.target.value="";return}const d=new FormData;d.append("attached_files[]",o),R.post(route("projects.upload-files",{project:this.project.id}),d,{preserveScroll:!0,onSuccess:()=>{E.fire({title:"Success!",text:`Successfully uploaded ${o.name}`,icon:"success",showConfirmButton:!1,timer:1500,timerProgressBar:!0}),s.target.value=""},onError:r=>{E.fire({title:"Error!",text:(r==null?void 0:r.message)||"Failed to upload file",icon:"error",confirmButtonColor:"#34c38f",confirmButtonText:"Ok"}),s.target.value=""}})},switchToDocumentsTab(){const s=document.querySelectorAll(".nav-tabs button"),e=Array.from(s).find(o=>o.textContent.includes("Documents"));e&&e.click()},submitComment(s){if(s instanceof FormData){this.form.processing=!0,R.post(route("projects.comments.store",this.project.id),s,{preserveScroll:!0,onSuccess:()=>{this.form.processing=!1},onError:e=>{console.error("Comment submission error:",e),this.form.processing=!1}});return}if(typeof s=="object"&&s.content){const e=new FormData;e.append("content",s.content.trim()),s.parent_id&&e.append("parent_id",String(s.parent_id)),this.submitComment(e);return}},startEdit(s){this.editingComment={id:s.id,content:s.content}},cancelEdit(){this.editingComment=null},updateComment(s){R.put(route("projects.comments.update",s),{content:this.editingComment.content},{preserveScroll:!0,onSuccess:()=>{this.editingComment=null}})},deleteComment(s){confirm("Are you sure you want to delete this comment?")&&R.delete(route("projects.comments.destroy",s),{preserveScroll:!0})},startReply(s){this.replyingTo=s,this.replyForm.content=""},cancelReply(){this.replyingTo=null,this.replyForm.content=""},submitReply(s){const e=new FormData;e.append("content",this.replyForm.content.trim()),e.append("parent_id",String(s)),this.submitComment(e),this.cancelReply()},handleFileAttachment(s){const o=Array.from(s.target.files).filter(b=>b.size>10485760?(this.$bvToast.toast(`File ${b.name} exceeds 10MB limit`,{title:"File too large",variant:"warning"}),!1):!0);this.form.attachments=[...this.form.attachments||[],...o]},removeAttachment(s){this.form.attachments.splice(s,1)},formatFileSize(s){if(!s)return"0 Bytes";const e=1024,o=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,b)).toFixed(2))+" "+o[b]},previewAttachment(s){s.type.startsWith("image/")&&(this.previewImage={url:route("comments.attachment.download",s.id),name:s.name},this.showImagePreview=!0)},isImage(s){return s==null?void 0:s.startsWith("image/")},canPreview(s){return["image/jpeg","image/png","image/gif","application/pdf","text/plain"].includes(s)},getFileIcon(s){return s!=null&&s.startsWith("image/")?"ri-image-fill":s==="application/pdf"?"ri-file-pdf-fill":s==="application/msword"||s==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?"ri-file-word-fill":s==="application/vnd.ms-excel"||s==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?"ri-file-excel-fill":s==="text/plain"?"ri-file-text-fill":"ri-file-fill"}},mounted(){new URLSearchParams(window.location.search).get("tab")==="documents"&&this.$nextTick(()=>{this.$refs.tabs.select("documents")})}},zt={class:"bg-primary-subtle"},It={class:"avatar-md"},Mt={class:"avatar-title bg-white rounded-circle"},Pt=["src","alt"],At={class:"fw-bold"},Tt={class:"hstack gap-3 flex-wrap"},Et={class:"fw-medium"},Lt={class:"fw-medium"},Ut={class:"text-muted"},Vt={class:"project-description"},Rt=["innerHTML"],Nt=["innerHTML"],Ht={class:"pt-3 border-top border-top-dashed mt-4"},Ot={class:"fs-15 mb-0"},Wt={class:"fs-15 mb-0"},Kt={key:0,class:"pt-3 border-top border-top-dashed mt-4"},qt={class:"vstack gap-2"},Gt={key:0,class:"position-relative"},Yt=["src","onClick","alt"],Jt={key:1,class:"ri-file-text-line fs-20"},Zt={class:"flex-grow-1 text-truncate"},Qt={class:"mb-0 fs-14 text-truncate"},Xt={class:"text-muted"},$t={class:"flex-shrink-0 ms-2"},te={class:"d-flex gap-1"},ee={class:"mx-n3"},se={class:"flex-shrink-0"},le={key:0,class:"avatar-xs"},ie=["src"],ne={key:1,class:"avatar-xs"},oe={class:"avatar-title rounded-circle bg-secondary"},ae={class:"flex-grow-1 ms-3"},re={class:"fs-14"},de={class:"text-muted ms-2"},ce={key:0},me={class:"d-flex gap-2"},ue={key:1},fe={class:"text-muted"},_e={key:0,class:"mt-2"},he={class:"d-flex gap-2 mt-2"},pe=["onClick"],ge=["onClick"],ve=["onClick"],be={key:1,class:"mt-3"},xe=["onSubmit"],ye={class:"d-flex gap-2"},ke={class:"d-flex flex-column gap-2"},we={key:2,class:"mt-3"},Ce={class:"flex-shrink-0"},Fe={key:0,class:"avatar-xs"},Be=["src"],je={key:1,class:"avatar-xs"},Se={class:"avatar-title rounded-circle bg-secondary"},De={class:"flex-grow-1 ms-3"},ze={class:"fs-14"},Ie={class:"text-muted ms-2"},Me={key:0},Pe={class:"d-flex gap-2"},Ae={key:1},Te={class:"text-muted"},Ee={key:0,class:"d-flex gap-2"},Le=["onClick"],Ue=["onClick"],Ve={key:1,class:"text-center py-4 text-muted"},Re={class:"mt-4 border-top pt-3"},Ne={class:"d-flex flex-wrap gap-2 fs-16"},He={class:"vstack gap-3"},Oe={class:"avatar-xs flex-shrink-0 me-3"},We=["src","alt"],Ke={key:1,class:"avatar-title bg-danger-subtle text-danger rounded-circle"},qe={class:"flex-grow-1"},Ge={class:"fs-13 mb-0"},Ye={class:"flex-shrink-0"},Je={class:"d-flex align-items-center gap-1"},Ze={class:"flex-shrink-0"},Qe={class:"d-flex gap-2"},Xe=["accept"],$e={key:0,class:"text-center p-2"},ts={key:1,class:"vstack gap-2"},es={class:"d-flex align-items-center"},ss={class:"flex-shrink-0 me-3"},ls={class:"avatar-sm"},is={class:"avatar-title bg-light text-secondary rounded fs-24"},ns={class:"flex-grow-1 overflow-hidden"},os={class:"fs-13 mb-1"},as={class:"text-body text-truncate d-block"},rs={class:"flex-shrink-0 ms-2"},ds={class:"d-flex gap-1"},cs=["href"],ms={key:0,class:"mt-2 text-center"},us={class:"card"},fs={class:"card-body"},_s={key:0,class:"text-center p-4"},hs={key:1,class:"table-responsive table-card"},ps={class:"table table-borderless align-middle mb-0"},gs={class:"d-flex align-items-center"},vs={class:"avatar-sm"},bs={class:"avatar-title bg-light text-secondary rounded fs-24"},xs={class:"ms-3 flex-grow-1"},ys={class:"fs-14 mb-0"},ks={class:"mb-4"},ws={class:"mt-4"},Cs={class:"card-title mb-4"},Fs={key:0,class:"text-center py-4"},Bs={key:1,class:"comment-list"},js={class:"flex-shrink-0"},Ss={key:0,class:"avatar-xs"},Ds=["src"],zs={key:1,class:"avatar-xs"},Is={class:"avatar-title rounded-circle bg-secondary"},Ms={class:"flex-grow-1 ms-3"},Ps={class:"fs-14"},As={class:"text-muted ms-2"},Ts={key:0},Es={class:"d-flex gap-2"},Ls={key:1},Us={class:"text-muted"},Vs={key:0,class:"mt-2"},Rs={class:"d-flex gap-2 mt-2"},Ns=["onClick"],Hs=["onClick"],Os=["onClick"],Ws={key:2,class:"mt-3"},Ks=["onSubmit"],qs={class:"d-flex gap-2"},Gs={class:"d-flex flex-column gap-2"},Ys={key:3,class:"mt-3"},Js={class:"flex-shrink-0"},Zs={key:0,class:"avatar-xs"},Qs=["src"],Xs={key:1,class:"avatar-xs"},$s={class:"avatar-title rounded-circle bg-secondary"},tl={class:"flex-grow-1 ms-3"},el={class:"fs-14"},sl={class:"text-muted ms-2"},ll={key:0},il={class:"d-flex gap-2"},nl={key:1},ol={class:"text-muted"},al={key:0,class:"d-flex gap-2"},rl=["onClick"],dl=["onClick"],cl={key:0,class:"text-center"},ml=["src","alt"],ul=["src"],fl={key:2,class:"text-start"},_l={key:3},hl=["src","alt"];function pl(s,e,o,b,d,r){const x=g("BCol"),S=g("BBadge"),B=g("BRow"),w=g("Link"),j=g("BCardBody"),D=g("BCard"),y=g("BButton"),K=g("CommentAttachment"),Z=g("simplebar"),q=g("CommentForm"),G=g("BCardTitle"),Y=g("BCardHeader"),A=g("BDropdownItem"),H=g("BDropdown"),O=g("BTab"),Q=g("BLink"),X=g("BTabs"),$=g("Layout"),J=g("BModal");return i(),a(k,null,[n($,null,{default:l(()=>[n(B,null,{default:l(()=>[n(x,{lg:"12"},{default:l(()=>[n(D,{"no-body":"",class:"mt-n4"},{default:l(()=>[t("div",zt,[n(j,{class:"pb-0 px-4"},{default:l(()=>[n(B,{class:"mb-3"},{default:l(()=>[n(x,{md:""},{default:l(()=>[n(B,{class:"align-items-center g-3"},{default:l(()=>[n(x,{md:"auto"},{default:l(()=>[t("div",It,[t("div",Mt,[t("img",{src:o.project.thumbnail_url,alt:o.project.title,class:"avatar-xs"},null,8,Pt)])])]),_:1}),n(x,{md:""},{default:l(()=>[t("div",null,[t("h4",At,m(o.project.title),1),t("div",Tt,[t("div",null,[e[10]||(e[10]=t("i",{class:"ri-building-line align-bottom me-1"},null,-1)),u(" "+m(o.project.category),1)]),e[13]||(e[13]=t("div",{class:"vr"},null,-1)),t("div",null,[e[11]||(e[11]=u(" Created: ")),t("span",Et,m(r.formatDate(o.project.created_at)),1)]),e[14]||(e[14]=t("div",{class:"vr"},null,-1)),t("div",null,[e[12]||(e[12]=u(" Due Date: ")),t("span",Lt,m(new Date(o.project.deadline).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})),1)]),e[15]||(e[15]=t("div",{class:"vr"},null,-1)),n(S,{class:T({"bg-success fs-12":o.project.status==="Completed","bg-warning fs-12":o.project.status==="In Progress","bg-danger fs-12":o.project.status==="Not Started","bg-info fs-12":o.project.status==="On Hold"})},{default:l(()=>[u(m(o.project.status),1)]),_:1},8,["class"]),n(S,{class:T({"bg-danger fs-12":o.project.priority==="High","bg-warning fs-12":o.project.priority==="Medium","bg-success fs-12":o.project.priority==="Low"})},{default:l(()=>[u(m(o.project.priority),1)]),_:1},8,["class"])])])]),_:1})]),_:1})]),_:1}),n(x,{md:"auto pt-md-3 pt-4"},{default:l(()=>[o.project.user_id===s.$page.props.auth.user.id?(i(),I(w,{key:0,href:s.route("projects.edit",o.project.id),class:"btn btn-primary"},{default:l(()=>e[16]||(e[16]=[u(" Edit Project ")])),_:1},8,["href"])):v("",!0)]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),n(B,null,{default:l(()=>[n(x,{lg:"12"},{default:l(()=>[n(X,{ref:"tabs",variant:"link","nav-class":"nav-tabs-custom border-bottom-0"},{default:l(()=>[n(O,{title:"Overview",active:"",class:"fw-semibold pt-2"},{default:l(()=>[n(B,null,{default:l(()=>[n(x,{xxl:"9"},{default:l(()=>[n(D,{"no-body":"",class:"mb-4"},{default:l(()=>[n(j,null,{default:l(()=>{var f;return[t("div",Ut,[e[17]||(e[17]=t("h6",{class:"mb-3 fw-semibold text-uppercase"},"Summary",-1)),t("div",Vt,[d.showFullDescription?(i(),a("div",{key:1,innerHTML:o.project.description},null,8,Nt)):(i(),a("div",{key:0,innerHTML:r.truncatedDescription},null,8,Rt)),o.project.description.length>629?(i(),I(y,{key:2,variant:"link",class:"p-0 mt-1",onClick:e[0]||(e[0]=c=>d.showFullDescription=!d.showFullDescription)},{default:l(()=>[u(m(d.showFullDescription?"Show Less":"Read More"),1)]),_:1})):v("",!0)])]),t("div",Ht,[n(B,null,{default:l(()=>[n(x,{lg:"3",sm:"6"},{default:l(()=>[t("div",null,[e[18]||(e[18]=t("p",{class:"mb-2 text-uppercase fw-medium"},"Created Date :",-1)),t("h5",Ot,m(r.formatDate(o.project.created_at)),1)])]),_:1}),n(x,{lg:"3",sm:"6"},{default:l(()=>[t("div",null,[e[19]||(e[19]=t("p",{class:"mb-2 text-uppercase fw-medium"},"Due Date :",-1)),t("h5",Wt,m(new Date(o.project.deadline).toLocaleDateString()),1)])]),_:1}),n(x,{lg:"3",sm:"6"},{default:l(()=>[t("div",null,[e[20]||(e[20]=t("p",{class:"mb-2 text-uppercase fw-medium"},"Priority :",-1)),n(S,{class:T({"bg-danger fs-12":o.project.priority==="High","bg-warning fs-12":o.project.priority==="Medium","bg-success fs-12":o.project.priority==="Low"})},{default:l(()=>[u(m(o.project.priority),1)]),_:1},8,["class"])])]),_:1}),n(x,{lg:"3",sm:"6"},{default:l(()=>[t("div",null,[e[21]||(e[21]=t("p",{class:"mb-2 text-uppercase fw-medium"},"Status :",-1)),n(S,{class:T({"bg-success fs-12":o.project.status==="Completed","bg-warning fs-12":o.project.status==="In Progress","bg-danger fs-12":o.project.status==="Not Started","bg-info fs-12":o.project.status==="On Hold"})},{default:l(()=>[u(m(o.project.status),1)]),_:1},8,["class"])])]),_:1})]),_:1}),(f=o.project.attached_files)!=null&&f.length?(i(),a("div",Kt,[e[25]||(e[25]=t("h6",{class:"mb-3 fw-semibold text-uppercase"},"Attached Files",-1)),t("div",qt,[(i(!0),a(k,null,F(o.project.attached_files,c=>(i(),a("div",{key:c.path,class:"d-flex align-items-center gap-2 bg-light p-2 rounded"},[r.isImage(c.type)?(i(),a("div",Gt,[t("img",{src:c.url,class:"attachment-thumbnail cursor-pointer",onClick:_=>r.viewFile(c),alt:c.name},null,8,Yt)])):(i(),a("i",Jt)),t("div",Zt,[t("h6",Qt,m(c.display_name||c.name),1),t("small",Xt,m(r.formatFileSize(c.size)),1)]),t("div",$t,[t("div",te,[r.canPreview(c.type)?(i(),I(y,{key:0,variant:"soft-primary",size:"sm",class:"btn-icon",onClick:_=>r.viewFile(c)},{default:l(()=>e[22]||(e[22]=[t("i",{class:"ri-eye-line"},null,-1)])),_:2},1032,["onClick"])):v("",!0),n(y,{variant:"soft-info",size:"sm",class:"btn-icon",href:c.url,download:""},{default:l(()=>e[23]||(e[23]=[t("i",{class:"ri-download-2-line"},null,-1)])),_:2},1032,["href"]),o.project.user_id===s.$page.props.auth.user.id?(i(),I(y,{key:1,variant:"soft-danger",size:"sm",class:"btn-icon",onClick:_=>r.deleteFile(c)},{default:l(()=>e[24]||(e[24]=[t("i",{class:"ri-delete-bin-line"},null,-1)])),_:2},1032,["onClick"])):v("",!0)])])]))),128))])])):v("",!0)])]}),_:1})]),_:1}),n(D,{"no-body":"",class:"mb-4"},{default:l(()=>[n(j,null,{default:l(()=>[e[32]||(e[32]=t("h5",{class:"card-title mb-4"},"Comments",-1)),t("div",ee,[n(Z,{"data-simplebar":"","data-simplebar-auto-hide":"false","data-simplebar-track":"primary",style:{"max-height":"275px"},class:"comments-scroll"},{default:l(()=>{var f;return[(f=o.project.comments)!=null&&f.length?(i(!0),a(k,{key:0},F(o.project.comments,c=>{var _,L,U,V;return i(),a("div",{key:c.id,class:"d-flex mb-4"},[t("div",se,[c.user.profile_photo_url?(i(),a("div",le,[t("img",{src:c.user.profile_photo_url,alt:"",class:"rounded-circle img-fluid"},null,8,ie)])):(i(),a("div",ne,[t("div",oe,m(c.user.name[0]),1)]))]),t("div",ae,[t("h5",re,[u(m(c.user.name)+" ",1),t("small",de,m(r.formatDate(c.created_at)),1)]),((_=d.editingComment)==null?void 0:_.id)===c.id?(i(),a("div",ce,[M(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=h=>d.editingComment.content=h),class:"form-control mb-2",rows:"2"},null,512),[[P,d.editingComment.content]]),t("div",me,[n(y,{size:"sm",variant:"primary",onClick:h=>r.updateComment(c.id)},{default:l(()=>e[26]||(e[26]=[u(" Save ")])),_:2},1032,["onClick"]),n(y,{size:"sm",variant:"light",onClick:r.cancelEdit},{default:l(()=>e[27]||(e[27]=[u(" Cancel ")])),_:1},8,["onClick"])])])):(i(),a("div",ue,[t("p",fe,m(c.content),1),(L=c.attachments)!=null&&L.length?(i(),a("div",_e,[(i(!0),a(k,null,F(c.attachments,h=>(i(),I(K,{key:h.id,attachment:h,onPreview:r.previewAttachment},null,8,["attachment","onPreview"]))),128))])):v("",!0),t("div",he,[t("a",{href:"#",class:"badge text-info bg-info-subtle",onClick:C(h=>r.startReply(c),["prevent"])}," Reply ",8,pe),c.user_id===s.$page.props.auth.user.id?(i(),a(k,{key:0},[t("a",{href:"#",class:"badge text-primary bg-primary-subtle",onClick:C(h=>r.startEdit(c),["prevent"])}," Edit ",8,ge),t("a",{href:"#",class:"badge text-danger bg-danger-subtle",onClick:C(h=>r.deleteComment(c.id),["prevent"])}," Delete ",8,ve)],64)):v("",!0)]),((U=d.replyingTo)==null?void 0:U.id)===c.id?(i(),a("div",be,[t("form",{onSubmit:C(h=>r.submitReply(c.id),["prevent"])},[t("div",ye,[M(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=h=>d.replyForm.content=h),class:"form-control",rows:"2",placeholder:"Write your reply..."},null,512),[[P,d.replyForm.content]]),t("div",ke,[n(y,{size:"sm",variant:"primary",type:"submit",disabled:!d.replyForm.content},{default:l(()=>e[28]||(e[28]=[u(" Reply ")])),_:1},8,["disabled"]),n(y,{size:"sm",variant:"light",onClick:r.cancelReply},{default:l(()=>e[29]||(e[29]=[u(" Cancel ")])),_:1},8,["onClick"])])])],40,xe)])):v("",!0)])),(V=c.replies)!=null&&V.length?(i(),a("div",we,[(i(!0),a(k,null,F(c.replies,h=>{var p;return i(),a("div",{key:h.id,class:"d-flex mt-3 ps-3 border-start"},[t("div",Ce,[h.user.profile_photo_url?(i(),a("div",Fe,[t("img",{src:h.user.profile_photo_url,alt:"",class:"rounded-circle img-fluid"},null,8,Be)])):(i(),a("div",je,[t("div",Se,m(h.user.name[0]),1)]))]),t("div",De,[t("h5",ze,[u(m(h.user.name)+" ",1),t("small",Ie,m(r.formatDate(h.created_at)),1)]),((p=d.editingComment)==null?void 0:p.id)===h.id?(i(),a("div",Me,[M(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=z=>d.editingComment.content=z),class:"form-control mb-2",rows:"2"},null,512),[[P,d.editingComment.content]]),t("div",Pe,[n(y,{size:"sm",variant:"primary",onClick:z=>r.updateComment(h.id)},{default:l(()=>e[30]||(e[30]=[u(" Save ")])),_:2},1032,["onClick"]),n(y,{size:"sm",variant:"light",onClick:r.cancelEdit},{default:l(()=>e[31]||(e[31]=[u(" Cancel ")])),_:1},8,["onClick"])])])):(i(),a("div",Ae,[t("p",Te,m(h.content),1),h.user_id===s.$page.props.auth.user.id?(i(),a("div",Ee,[t("a",{href:"#",class:"badge text-primary bg-primary-subtle",onClick:C(z=>r.startEdit(h),["prevent"])}," Edit ",8,Le),t("a",{href:"#",class:"badge text-danger bg-danger-subtle",onClick:C(z=>r.deleteComment(h.id),["prevent"])}," Delete ",8,Ue)])):v("",!0)]))])])}),128))])):v("",!0)])])}),128)):(i(),a("div",Ve," No comments yet. Be the first to comment! "))]}),_:1})]),t("div",Re,[n(q,{processing:d.form.processing,"parent-id":d.form.parent_id,onSubmit:r.submitComment},null,8,["processing","parent-id","onSubmit"])])]),_:1})]),_:1})]),_:1}),n(x,{lg:"3"},{default:l(()=>[n(D,{"no-body":""},{default:l(()=>[n(j,null,{default:l(()=>[e[33]||(e[33]=t("h5",{class:"card-title mb-4"},"Skills",-1)),t("div",Ne,[(i(!0),a(k,null,F(o.project.skills,f=>(i(),I(S,{key:f,variant:"secondary-subtle",tag:"div",class:"fw-medium bg-secondary-subtle text-secondary"},{default:l(()=>[u(m(f),1)]),_:2},1024))),128))])]),_:1})]),_:1}),n(D,{"no-body":"",class:"mt-4"},{default:l(()=>[n(Y,{class:"align-items-center d-flex border-bottom-dashed"},{default:l(()=>[n(G,{class:"mb-0 flex-grow-1"},{default:l(()=>e[34]||(e[34]=[u("Members")])),_:1})]),_:1}),n(j,null,{default:l(()=>[t("div",He,[(i(!0),a(k,null,F(o.project.users,f=>(i(),a("div",{key:f.id,class:"d-flex align-items-center"},[t("div",Oe,[f.profile_photo_path?(i(),a("img",{key:0,src:`/storage/${f.profile_photo_path}`,alt:f.name,class:"img-fluid rounded-circle"},null,8,We)):(i(),a("div",Ke,m(f.name.charAt(0)),1))]),t("div",qe,[t("h5",Ge,[n(w,{href:"#",class:"text-body d-block"},{default:l(()=>[u(m(f.name),1)]),_:2},1024)])]),t("div",Ye,[t("div",Je,[n(H,{variant:"link","toggle-class":"btn btn-icon btn-sm fs-16 text-muted arrow-none","menu-class":"dropdown-menu-end"},{"button-content":l(()=>e[35]||(e[35]=[t("i",{class:"ri-more-fill"},null,-1)])),default:l(()=>[n(A,null,{default:l(()=>[n(w,{href:s.route("profile.show",f.id),class:"text-reset"},{default:l(()=>e[36]||(e[36]=[t("i",{class:"ri-eye-fill me-2 align-bottom text-muted"},null,-1),u("View Profile ")])),_:2},1032,["href"])]),_:2},1024)]),_:2},1024)])])]))),128))])]),_:1})]),_:1}),n(D,{"no-body":"",class:"mt-4"},{default:l(()=>[n(Y,{class:"align-items-center d-flex border-bottom-dashed"},{default:l(()=>[n(G,{class:"mb-0 flex-grow-1"},{default:l(()=>e[37]||(e[37]=[u("Attachments")])),_:1}),t("div",Ze,[t("div",Qe,[e[38]||(e[38]=t("label",{for:"file-upload",class:"btn btn-soft-success btn-sm mb-0"},[t("i",{class:"ri-upload-2-fill me-1 align-bottom"}),u(" Upload ")],-1)),t("input",{id:"file-upload",type:"file",class:"d-none",onChange:e[4]||(e[4]=(...f)=>r.handleFileUpload&&r.handleFileUpload(...f)),accept:d.acceptedFileTypes},null,40,Xe)])])]),_:1}),n(j,null,{default:l(()=>{var f;return[(f=o.project.attached_files)!=null&&f.length?(i(),a("div",ts,[(i(!0),a(k,null,F(o.project.attached_files.slice(0,4),c=>(i(),a("div",{key:c.path,class:"border rounded border-dashed p-2"},[t("div",es,[t("div",ss,[t("div",ls,[t("div",is,[t("i",{class:T(r.getFileIcon(c.type))},null,2)])])]),t("div",ns,[t("h5",os,[t("span",as,m(c.display_name||c.name),1)]),t("div",null,m(Math.round(c.size/1024))+" KB",1)]),t("div",rs,[t("div",ds,[t("a",{href:c.url,class:"btn btn-icon text-muted btn-sm fs-18",download:""},e[40]||(e[40]=[t("i",{class:"ri-download-2-line"},null,-1)]),8,cs),n(H,{variant:"link","toggle-class":"btn btn-icon btn-sm fs-18 text-muted arrow-none","menu-class":"dropdown-menu-end"},{"button-content":l(()=>e[41]||(e[41]=[t("i",{class:"ri-more-fill"},null,-1)])),default:l(()=>[n(A,{onClick:_=>r.viewFile(c)},{default:l(()=>e[42]||(e[42]=[t("i",{class:"ri-eye-fill me-2 align-bottom text-muted"},null,-1),u("View ")])),_:2},1032,["onClick"]),n(A,{onClick:_=>r.deleteFile(c)},{default:l(()=>e[43]||(e[43]=[t("i",{class:"ri-delete-bin-fill align-bottom me-2 text-muted"},null,-1),u("Delete ")])),_:2},1032,["onClick"])]),_:2},1024)])])])]))),128)),o.project.attached_files.length>4?(i(),a("div",ms,[n(y,{type:"button",variant:"secondary",onClick:r.switchToDocumentsTab},{default:l(()=>e[44]||(e[44]=[u(" View more ")])),_:1},8,["onClick"])])):v("",!0)])):(i(),a("div",$e,e[39]||(e[39]=[t("div",{class:"avatar-sm mx-auto mb-3"},[t("div",{class:"avatar-title rounded bg-light text-secondary"},[t("i",{class:"ri-file-text-line fs-20"})])],-1),t("p",{class:"text-muted mb-0"},"No attachments uploaded yet",-1)])))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(O,{title:"Documents",class:"fw-semibold pt-2"},{default:l(()=>[t("div",us,[t("div",fs,[e[51]||(e[51]=t("div",{class:"d-flex align-items-center mb-4"},[t("h5",{class:"card-title flex-grow-1"},"Documents")],-1)),n(B,null,{default:l(()=>{var f;return[(f=o.project.attached_files)!=null&&f.length?(i(),a("div",hs,[t("table",ps,[e[50]||(e[50]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{scope:"col"},"File Name"),t("th",{scope:"col"},"Type"),t("th",{scope:"col"},"Size"),t("th",{scope:"col"},"Upload Date"),t("th",{scope:"col",style:{width:"120px"}},"Action")])],-1)),t("tbody",null,[(i(!0),a(k,null,F(o.project.attached_files,c=>(i(),a("tr",{key:c.path},[t("td",null,[t("div",gs,[t("div",vs,[t("div",bs,[t("i",{class:T(r.getFileIcon(c.type))},null,2)])]),t("div",xs,[t("h5",ys,[n(Q,{href:c.url,class:"text-body"},{default:l(()=>[u(m(c.display_name||c.name),1)]),_:2},1032,["href"])])])])]),t("td",null,m(c.type||"Document"),1),t("td",null,m(Math.round(c.size/1024))+" KB",1),t("td",null,m(r.formatDate(c.created_at)),1),t("td",null,[n(H,{variant:"link","toggle-class":"btn btn-soft-secondary btn-sm btn-icon arrow-none","menu-class":"dropdown-menu-end",offset:{alignmentAxis:-130,crossAxis:0,mainAxis:10}},{"button-content":l(()=>e[46]||(e[46]=[t("i",{class:"ri-more-fill"},null,-1)])),default:l(()=>[n(A,{onClick:_=>r.viewFile(c)},{default:l(()=>e[47]||(e[47]=[t("i",{class:"ri-eye-fill me-2 align-bottom text-muted"},null,-1),u("View ")])),_:2},1032,["onClick"]),n(A,{href:c.url,download:""},{default:l(()=>e[48]||(e[48]=[t("i",{class:"ri-download-2-fill me-2 align-bottom text-muted"},null,-1),u("Download ")])),_:2},1032,["href"]),n(A,{onClick:_=>r.deleteFile(c)},{default:l(()=>e[49]||(e[49]=[t("i",{class:"ri-delete-bin-5-fill me-2 align-bottom text-muted"},null,-1),u("Delete ")])),_:2},1032,["onClick"])]),_:2},1024)])]))),128))])])])):(i(),a("div",_s,e[45]||(e[45]=[t("div",{class:"avatar-sm mx-auto mb-4"},[t("div",{class:"avatar-title rounded bg-light text-secondary"},[t("i",{class:"ri-file-text-line fs-24"})])],-1),t("h5",{class:"mb-1"},"No Documents Available",-1),t("p",{class:"text-muted"},"No documents have been attached to this project yet.",-1)])))]}),_:1})])])]),_:1}),n(O,{title:"Comments",class:"fw-semibold pt-2"},{default:l(()=>[n(D,{"no-body":""},{default:l(()=>[n(j,null,{default:l(()=>{var f,c;return[t("div",ks,[e[52]||(e[52]=t("h5",{class:"card-title mb-3"},"Add Comment",-1)),n(q,{processing:d.form.processing,"parent-id":d.form.parent_id,onSubmit:r.submitComment},null,8,["processing","parent-id","onSubmit"])]),t("div",ws,[t("h5",Cs,"Comments ("+m(((f=o.project.comments)==null?void 0:f.length)||0)+")",1),(c=o.project.comments)!=null&&c.length?(i(),a("div",Bs,[(i(!0),a(k,null,F(o.project.comments,_=>{var L,U,V,h;return i(),a("div",{key:_.id,class:"d-flex mb-4"},[t("div",js,[_.user.profile_photo_url?(i(),a("div",Ss,[t("img",{src:_.user.profile_photo_url,alt:"",class:"rounded-circle img-fluid"},null,8,Ds)])):(i(),a("div",zs,[t("div",Is,m(_.user.name[0]),1)]))]),t("div",Ms,[t("h5",Ps,[u(m(_.user.name)+" ",1),t("small",As,m(r.formatDate(_.created_at)),1)]),((L=d.editingComment)==null?void 0:L.id)===_.id?(i(),a("div",Ts,[M(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=p=>d.editingComment.content=p),class:"form-control mb-2",rows:"2"},null,512),[[P,d.editingComment.content]]),t("div",Es,[n(y,{size:"sm",variant:"primary",onClick:p=>r.updateComment(_.id)},{default:l(()=>e[54]||(e[54]=[u(" Save ")])),_:2},1032,["onClick"]),n(y,{size:"sm",variant:"light",onClick:r.cancelEdit},{default:l(()=>e[55]||(e[55]=[u(" Cancel ")])),_:1},8,["onClick"])])])):(i(),a("div",Ls,[t("p",Us,m(_.content),1),(U=_.attachments)!=null&&U.length?(i(),a("div",Vs,[(i(!0),a(k,null,F(_.attachments,p=>(i(),I(K,{key:p.id,attachment:p,onPreview:r.previewAttachment},null,8,["attachment","onPreview"]))),128))])):v("",!0),t("div",Rs,[t("a",{href:"#",class:"badge text-info bg-info-subtle",onClick:C(p=>r.startReply(_),["prevent"])}," Reply ",8,Ns),_.user_id===s.$page.props.auth.user.id?(i(),a(k,{key:0},[t("a",{href:"#",class:"badge text-primary bg-primary-subtle",onClick:C(p=>r.startEdit(_),["prevent"])}," Edit ",8,Hs),t("a",{href:"#",class:"badge text-danger bg-danger-subtle",onClick:C(p=>r.deleteComment(_.id),["prevent"])}," Delete ",8,Os)],64)):v("",!0)])])),((V=d.replyingTo)==null?void 0:V.id)===_.id?(i(),a("div",Ws,[t("form",{onSubmit:C(p=>r.submitReply(_.id),["prevent"])},[t("div",qs,[M(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=p=>d.replyForm.content=p),class:"form-control",rows:"2",placeholder:"Write your reply..."},null,512),[[P,d.replyForm.content]]),t("div",Gs,[n(y,{size:"sm",variant:"primary",type:"submit",disabled:!d.replyForm.content},{default:l(()=>e[56]||(e[56]=[u(" Reply ")])),_:1},8,["disabled"]),n(y,{size:"sm",variant:"light",onClick:r.cancelReply},{default:l(()=>e[57]||(e[57]=[u(" Cancel ")])),_:1},8,["onClick"])])])],40,Ks)])):v("",!0),(h=_.replies)!=null&&h.length?(i(),a("div",Ys,[(i(!0),a(k,null,F(_.replies,p=>{var z;return i(),a("div",{key:p.id,class:"d-flex mt-3 ps-3 border-start"},[t("div",Js,[p.user.profile_photo_url?(i(),a("div",Zs,[t("img",{src:p.user.profile_photo_url,alt:"",class:"rounded-circle img-fluid"},null,8,Qs)])):(i(),a("div",Xs,[t("div",$s,m(p.user.name[0]),1)]))]),t("div",tl,[t("h5",el,[u(m(p.user.name)+" ",1),t("small",sl,m(r.formatDate(p.created_at)),1)]),((z=d.editingComment)==null?void 0:z.id)===p.id?(i(),a("div",ll,[M(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=N=>d.editingComment.content=N),class:"form-control mb-2",rows:"2"},null,512),[[P,d.editingComment.content]]),t("div",il,[n(y,{size:"sm",variant:"primary",onClick:N=>r.updateComment(p.id)},{default:l(()=>e[58]||(e[58]=[u(" Save ")])),_:2},1032,["onClick"]),n(y,{size:"sm",variant:"light",onClick:r.cancelEdit},{default:l(()=>e[59]||(e[59]=[u(" Cancel ")])),_:1},8,["onClick"])])])):(i(),a("div",nl,[t("p",ol,m(p.content),1),p.user_id===s.$page.props.auth.user.id?(i(),a("div",al,[t("a",{href:"#",class:"badge text-primary bg-primary-subtle",onClick:C(N=>r.startEdit(p),["prevent"])}," Edit ",8,rl),t("a",{href:"#",class:"badge text-danger bg-danger-subtle",onClick:C(N=>r.deleteComment(p.id),["prevent"])}," Delete ",8,dl)])):v("",!0)]))])])}),128))])):v("",!0)])])}),128))])):(i(),a("div",Fs,e[53]||(e[53]=[t("div",{class:"avatar-sm mx-auto mb-4"},[t("div",{class:"avatar-title rounded-circle bg-light text-primary fs-24"},[t("i",{class:"ri-chat-3-line"})])],-1),t("h5",null,"Be the first to comment",-1)])))])]}),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}),n(J,{modelValue:d.showFilePreview,"onUpdate:modelValue":e[8]||(e[8]=f=>d.showFilePreview=f),size:"lg",title:"File Preview","hide-footer":""},{default:l(()=>{var f;return[d.selectedFile?(i(),a("div",cl,[(f=d.selectedFile.type)!=null&&f.startsWith("image/")?(i(),a("img",{key:0,src:d.selectedFile.url,alt:d.selectedFile.name,class:"img-fluid"},null,8,ml)):d.selectedFile.type==="application/pdf"?(i(),a("iframe",{key:1,src:d.selectedFile.url,width:"100%",height:"500px",frameborder:"0"},null,8,ul)):d.selectedFile.type==="text/plain"?(i(),a("pre",fl,"                "+m(d.selectedFile.content)+`
            `,1)):(i(),a("div",_l,[e[61]||(e[61]=t("p",null,"Preview not available for this file type",-1)),n(y,{href:d.selectedFile.url,target:"_blank"},{default:l(()=>e[60]||(e[60]=[u("Open File")])),_:1},8,["href"])]))])):v("",!0)]}),_:1},8,["modelValue"]),n(J,{modelValue:d.showImagePreview,"onUpdate:modelValue":e[9]||(e[9]=f=>d.showImagePreview=f),size:"lg",title:"Image Preview","hide-footer":"","body-class":"p-0"},{default:l(()=>[d.previewImage?(i(),a("img",{key:0,src:d.previewImage.url,class:"img-fluid w-100",alt:d.previewImage.name},null,8,hl)):v("",!0)]),_:1},8,["modelValue"])],64)}const Il=W(Dt,[["render",pl]]);export{Il as default};
