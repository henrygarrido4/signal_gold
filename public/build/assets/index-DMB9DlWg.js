import{A as le}from"./vue-feather-icons.es-DhCg6NIe.js";import{j as re,Z as oe,r,I as me,c as d,w as i,o,a as t,f as p,h as C,d as _,e as N,n as ce,t as h,k as v,g as z,F as V,l as pe}from"./app-BWABJYdq.js";import{L as de}from"./main-BZMVmuB9.js";import{P as ue}from"./page-header-CWp0LBfO.js";import{C as ge}from"./component-GK_D4hhz.js";/* empty css                  */import fe from"./audiences-metrics-DDwsTo3t.js";import Ce from"./audiences-sessions-H8IoUb5o.js";import _e from"./country-D6siZukH.js";import he from"./referrals-Bq5gBmVE.js";import ve from"./sessions-countries-2pSlgfvm.js";import be from"./top-pages-6gwvcLs0.js";import ye from"./users-DFX7RCVz.js";import Be from"./campaign-comparison-results-BtLePwAK.js";import we from"./campaign-widget-DckcgdTW.js";import Se from"./statistical-significance-Cw7nELkw.js";import De from"./date-selector-CMq4Jcmg.js";import{_ as Me}from"./SaveToSnapshotButton-BiWKK4s4.js";import xe from"./analytics-widget-34yIofio.js";import{T as ke,t as Y}from"./TableauDashboard-D3BqF5WG.js";import Ae from"./campaign-performance-chart-Df9vxlNN.js";import{_ as Te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./simplebar-vue.esm-CZuBtKrH.js";import"./avatar-2-C9CWE8xV.js";import"./avatar-3-CcIxMpdW.js";import"./avatar-5-BPjc6EDL.js";import"./russia-pMTSjNGF.js";import"./logo-signal-9z7U6Iga.js";import"./logo-dark-BbIT5rJd.js";import"./logo-light-BfYujB8V.js";import"./vue3-count-to.esm-CLX3ExJ9.js";import"./getChartColorsArray-DXKIp7ac.js";import"./index-BJkVjQC_.js";import"./USA-BQkF46h-.js";import"./sweetalert2.esm.all-CumHaNCI.js";const Fe={components:{AlertTriangleIcon:le,Layout:de,PageHeader:ue,AudiencesSessions:Ce,AudiencesMetrics:fe,Country:_e,Referrals:he,SessionsCounties:ve,TopPages:be,Users:ye,Link:re,Head:oe,CampaignComparisonResults:Be,CampaignWidget:we,StatisticalSignificance:Se,flatPickr:ge,DateSelector:De,SaveToSnapshotButton:Me,AnalyticsWidget:xe,TableauDashboard:ke,CampaignPerformanceChart:Ae},data(){return{selectedCampaigns:["",""],campaignOptions:[{value:null,text:"Select a campaign"}],allGroups:!1,isLoadingGroups:!1,isDashboardMinimized:!0,isTableauLoading:!0,campaignAMetrics:null,campaignBMetrics:null,comparisonPeriod:"mtd",periodOptions:[{value:"custom",text:"Custom Range"}],dateRange:"",showDatePicker:!1,campaignSearchA:"",campaignSearchB:"",dateConfig:{mode:"range",maxDate:"today",dateFormat:"Y-m-d",onChange:s=>{s.length===2&&(this.dateRange=s.map(a=>this.formatDate(a)).join(" to "),[this.startDate,this.endDate]=s.map(a=>this.formatDate(a)))}},startDate:"",endDate:"",metrics:{currentPeriod:{totals:{emails_delivered:0,entries:0,leads:0},rates:{conversion_rate:0},trends:{delivery_rate:0,entry_rate:0,lead_rate:0,conversion_trend:0}}},allCampaignNames:[],campaignMetrics:{},allCampaignMetrics:{},showSignInAlert:!1}},computed:{extraCampaigns(){return this.selectedCampaigns.slice(2)},today(){return new Date().toISOString().split("T")[0]},filteredCampaignsA(){if(this.campaignSearchA){const s=this.allCampaignNames.filter(a=>a.toLowerCase().includes(this.campaignSearchA.toLowerCase())).slice(0,6).map(a=>({value:a,text:a}));return[{value:null,text:"Select a campaign"},...s]}return this.campaignOptions},filteredCampaignsB(){if(this.campaignSearchB){const s=this.allCampaignNames.filter(a=>a.toLowerCase().includes(this.campaignSearchB.toLowerCase())).slice(0,6).map(a=>({value:a,text:a}));return[{value:null,text:"Select a campaign"},...s]}return this.campaignOptions}},methods:{updateTableauFilter(s,a){var b;(b=this.$refs.tableau)!=null&&b.isVizReady?this.$refs.tableau.applyFilter(s,a):console.warn("⚠ Cannot apply filter: Tableau is not ready yet.")},clearTableauFilters(){var s;(s=this.$refs.tableau)!=null&&s.isVizReady?(this.$refs.tableau.clearFilter("Campaign Name"),this.$refs.tableau.clearFilter("Email Campaign Groups"),this.$refs.tableau.clearFilter("Date")):console.warn("⚠ Cannot clear filters: Tableau is not ready yet.")},async handleCampaignNamesUpdated(s){this.campaignNames=s;const a=await Y.getCampaignMetrics(s);this.allCampaignMetrics=a,this.allCampaignNames=s;const b=s.slice(0,6);this.campaignOptions=[{value:null,text:"Select a campaign"},...b.map(R=>({value:R,text:R}))]},formatTableauDate(s){return s?new Date(s).toISOString().split("T")[0]:null},addCampaignSelector(){this.selectedCampaigns.push("")},removeCampaignSelector(s){this.selectedCampaigns.splice(s,1)},compareCampaigns(){},downloadData(){},async updateCampaignMetrics(){const s=await Y.getCampaignMetrics(this.selectedCampaigns);s&&this.selectedCampaigns[0]&&(this.campaignAMetrics={...s[this.selectedCampaigns[0]],campaignName:this.selectedCampaigns[0]}),s&&this.selectedCampaigns[1]&&(this.campaignBMetrics={...s[this.selectedCampaigns[1]],campaignName:this.selectedCampaigns[1]})}},watch:{comparisonPeriod(s){this.showDatePicker=s==="custom",s!=="custom"&&this.updateTableauFilter("Date",null)},selectedCampaigns:{deep:!0,async handler(s){const a=s.filter(Boolean);a.length>0?(this.updateTableauFilter("Campaign Name",a),await this.updateCampaignMetrics()):(this.clearTableauFilters(),this.campaignMetrics={})}},dateRange(s){s&&this.startDate&&this.endDate&&this.updateTableauFilter("Date",[this.startDate,this.endDate])}},mounted(){setTimeout(()=>{var s;(s=this.$refs.tableau)!=null&&s.isVizReady||(this.showSignInAlert=!0)},5e3)}},Pe={class:"d-flex justify-content-between align-items-center"},Le={class:"d-flex align-items-center"},Ne={class:"ms-2"},ze={key:1,class:"text-muted"},Ve={key:0,class:"alert alert-warning m-3 d-flex align-items-center",role:"alert"},Re={class:"h-100 d-flex flex-column"},Ge={key:1,class:"ri-eye-line align-middle"},Ie={class:"d-flex gap-2"},Ee={class:"mb-3 text-muted"},Oe={class:"mb-3 text-muted"};function Ue(s,a,b,R,e,u){const Z=r("PageHeader"),q=r("BCardTitle"),U=r("BSpinner"),G=r("BButton"),J=r("BCardHeader"),Q=r("TableauDashboard"),H=r("BCardBody"),j=r("BCard"),m=r("BCol"),g=r("BRow"),K=r("BFormInput"),W=r("BDropdownDivider"),I=r("BDropdownItem"),E=r("BDropdown"),O=r("BButtonGroup"),X=r("DateSelector"),$=r("BFormSelect"),f=r("analytics-widget"),ee=r("CampaignComparisonResults"),ae=r("CampaignPerformanceChart"),te=r("TopPages"),ie=r("StatisticalSignificance"),se=r("Layout"),ne=me("b-tooltip");return o(),d(se,null,{default:i(()=>[t(Z,{title:"Analytics",pageTitle:"Dashboards"}),t(g,{class:"mb-4"},{default:i(()=>[t(m,{cols:"12"},{default:i(()=>[t(j,{"no-body":""},{default:i(()=>{var n;return[t(J,null,{default:i(()=>{var l;return[p("div",Pe,[p("div",Le,[t(q,{class:"mb-0"},{default:i(()=>a[12]||(a[12]=[C("Email Analytics Dashboard")])),_:1}),p("div",Ne,[e.isTableauLoading?(o(),d(U,{key:0,small:"",variant:"primary"})):(l=s.$refs.tableau)!=null&&l.isVizReady?N("",!0):(o(),_("small",ze," (Not signed in) "))])]),t(G,{variant:"soft-primary",size:"sm",onClick:a[0]||(a[0]=c=>e.isDashboardMinimized=!e.isDashboardMinimized)},{default:i(()=>[p("i",{class:ce(e.isDashboardMinimized?"ri-fullscreen-line":"ri-fullscreen-exit-line")},null,2),C(" "+h(e.isDashboardMinimized?"Expand":"Minimize"),1)]),_:1})])]}),_:1}),e.showSignInAlert&&!((n=s.$refs.tableau)!=null&&n.isVizReady)&&e.isDashboardMinimized?(o(),_("div",Ve,a[13]||(a[13]=[p("i",{class:"ri-error-warning-line me-2"},null,-1),C(" Please verify that you are signed in to Tableau Cloud. If you're already signed in, the visualization may take a moment to load. ")]))):N("",!0),t(H,null,{default:i(()=>[t(Q,{ref:"tableau",vizUrl:"https://us-west-2b.online.tableau.com/t/cars/views/EmailDashboards/EmailDashboard",height:e.isDashboardMinimized?"0":"800",onCampaignNamesUpdated:u.handleCampaignNamesUpdated,onLoading:a[1]||(a[1]=l=>e.isTableauLoading=l)},null,8,["height","onCampaignNamesUpdated"])]),_:1})]}),_:1})]),_:1})]),_:1}),t(g,null,{default:i(()=>[t(m,{xxl:"8",lg:"12",cols:"12"},{default:i(()=>[p("div",Re,[t(j,{"no-body":"",class:"mb-4"},{default:i(()=>[t(H,null,{default:i(()=>[a[15]||(a[15]=p("div",{class:"d-flex justify-content-between align-items-center mb-4"},[p("h5",{class:"card-title mb-2"},"Campaign Comparison")],-1)),t(g,null,{default:i(()=>[t(m,{md:"4",sm:"12",class:"mb-3"},{default:i(()=>[t(O,{class:"w-100"},{default:i(()=>[t(E,{variant:"primary",text:e.selectedCampaigns[0]||"Select Campaign A",class:"w-100"},{default:i(()=>[p("div",{class:"px-3 py-2",onClick:a[5]||(a[5]=v(()=>{},["stop"]))},[t(K,{modelValue:e.campaignSearchA,"onUpdate:modelValue":a[2]||(a[2]=n=>e.campaignSearchA=n),type:"search",placeholder:"Search campaigns...",class:"form-control",onClick:a[3]||(a[3]=v(()=>{},["stop"])),onKeydown:a[4]||(a[4]=v(()=>{},["stop"]))},null,8,["modelValue"])]),t(W),(o(!0),_(V,null,z(u.filteredCampaignsA,n=>(o(),d(I,{key:n.value,onClick:()=>{e.selectedCampaigns[0]=n.value,u.updateTableauFilter("Campaign Name",e.selectedCampaigns.filter(Boolean))},active:e.selectedCampaigns[0]===n.value},{default:i(()=>[C(h(n.text),1)]),_:2},1032,["onClick","active"]))),128))]),_:1},8,["text"])]),_:1})]),_:1}),t(m,{md:"4",sm:"12",class:"mb-3"},{default:i(()=>[t(O,{class:"w-100"},{default:i(()=>[t(E,{variant:"primary",text:e.selectedCampaigns[1]||"Select Campaign B",class:"w-100"},{default:i(()=>[p("div",{class:"px-3 py-2",onClick:a[9]||(a[9]=v(()=>{},["stop"]))},[t(K,{modelValue:e.campaignSearchB,"onUpdate:modelValue":a[6]||(a[6]=n=>e.campaignSearchB=n),type:"search",placeholder:"Search campaigns...",class:"form-control",onClick:a[7]||(a[7]=v(()=>{},["stop"])),onKeydown:a[8]||(a[8]=v(()=>{},["stop"]))},null,8,["modelValue"])]),t(W),(o(!0),_(V,null,z(u.filteredCampaignsB,n=>(o(),d(I,{key:n.value,onClick:()=>{e.selectedCampaigns[1]=n.value,u.updateTableauFilter("Campaign Name",e.selectedCampaigns.filter(Boolean))},active:e.selectedCampaigns[1]===n.value},{default:i(()=>[C(h(n.text),1)]),_:2},1032,["onClick","active"]))),128))]),_:1},8,["text"])]),_:1})]),_:1}),t(m,{md:"3",sm:"11",class:"mb-3"},{default:i(()=>[t(O,{class:"w-100"},{default:i(()=>{var n;return[t(E,{variant:"primary",text:((n=e.periodOptions.find(l=>l.value===e.comparisonPeriod))==null?void 0:n.text)||"Select Period",class:"w-100"},{default:i(()=>[(o(!0),_(V,null,z(e.periodOptions,l=>(o(),d(I,{key:l.value,onClick:c=>e.comparisonPeriod=l.value,active:e.comparisonPeriod===l.value},{default:i(()=>[C(h(l.text),1)]),_:2},1032,["onClick","active"]))),128))]),_:1},8,["text"])]}),_:1})]),_:1}),t(m,{md:"1",sm:"1",class:"mb-3 d-flex align-items-start"},{default:i(()=>[pe((o(),d(G,{title:"Show all campaign groups",variant:"outline-primary",pressed:e.allGroups,disabled:e.isLoadingGroups,onClick:a[10]||(a[10]=async()=>{var n;try{e.isLoadingGroups=!0,e.allGroups=!e.allGroups;const l=e.allGroups?"All":null;await u.updateTableauFilter("Email Campaign groups ",l),await((n=this.$refs.tableau)==null?void 0:n.refreshCampaigns())}catch(l){console.error("Error toggling groups:",l),this.$toast.error("Failed to update campaign groups"),e.allGroups=!e.allGroups}finally{e.isLoadingGroups=!1}})},{default:i(()=>[e.isLoadingGroups?(o(),d(U,{key:0,small:""})):(o(),_("i",Ge))]),_:1},8,["pressed","disabled"])),[[ne,void 0,void 0,{hover:!0}]])]),_:1})]),_:1}),e.showDatePicker?(o(),d(g,{key:0,class:"mb-3"},{default:i(()=>[t(m,{md:"12"},{default:i(()=>[t(X,{onPeriodSelected:a[11]||(a[11]=async({start:n,end:l})=>{var c;await((c=this.$refs.tableau)==null?void 0:c.getAvailableFields()),u.updateTableauFilter("Date",[n,l]),await this.updateCampaignMetrics()})})]),_:1})]),_:1})):N("",!0),e.selectedCampaigns.length>2?(o(),d(g,{key:1},{default:i(()=>[(o(!0),_(V,null,z(u.extraCampaigns,(n,l)=>(o(),d(m,{md:"4",key:l+2,class:"mb-3"},{default:i(()=>[p("div",Ie,[t($,{modelValue:e.selectedCampaigns[l+2],"onUpdate:modelValue":c=>e.selectedCampaigns[l+2]=c,options:e.campaignOptions,placeholder:`Select Campaign ${String.fromCharCode(67+l)}`},null,8,["modelValue","onUpdate:modelValue","options","placeholder"]),t(G,{variant:"outline-danger",size:"sm",onClick:c=>u.removeCampaignSelector(l+2)},{default:i(()=>a[14]||(a[14]=[C(" × ")])),_:2},1032,["onClick"])])]),_:2},1024))),128))]),_:1})):N("",!0)]),_:1})]),_:1}),t(g,{class:"mb-4"},{default:i(()=>{var n,l,c,y,B,w,S,D,M,x,k,A,T,F,P,L;return[t(m,{cols:"12"},{default:i(()=>[p("h5",Ee,h(e.selectedCampaigns[0]||"Campaign A"),1)]),_:1}),t(f,{title:"Delivered",value:((l=(n=e.campaignAMetrics)==null?void 0:n.totals)==null?void 0:l.emails_delivered)||0,trend:((y=(c=e.campaignAMetrics)==null?void 0:c.trends)==null?void 0:y.delivery_rate)||0,icon:"ri-mail-send-line",color:"primary"},null,8,["value","trend"]),t(f,{title:"Entries",value:((w=(B=e.campaignAMetrics)==null?void 0:B.totals)==null?void 0:w.entries)||0,trend:((D=(S=e.campaignAMetrics)==null?void 0:S.trends)==null?void 0:D.entry_rate)||0,icon:"ri-user-add-line",color:"success"},null,8,["value","trend"]),t(f,{title:"Leads",value:((x=(M=e.campaignAMetrics)==null?void 0:M.totals)==null?void 0:x.leads)||0,trend:((A=(k=e.campaignAMetrics)==null?void 0:k.trends)==null?void 0:A.lead_rate)||0,icon:"ri-team-line",color:"warning"},null,8,["value","trend"]),t(f,{title:"Conversion Rate",value:((F=(T=e.campaignAMetrics)==null?void 0:T.rates)==null?void 0:F.conversion_rate)||0,trend:((L=(P=e.campaignAMetrics)==null?void 0:P.trends)==null?void 0:L.conversion_trend)||0,suffix:"%",icon:"ri-percent-line",color:"info"},null,8,["value","trend"])]}),_:1}),t(g,{class:"mb-4"},{default:i(()=>{var n,l,c,y,B,w,S,D,M,x,k,A,T,F,P,L;return[t(m,{cols:"12"},{default:i(()=>[p("h5",Oe,h(e.selectedCampaigns[1]||"Campaign B"),1)]),_:1}),t(f,{title:"Delivered",value:((l=(n=e.campaignBMetrics)==null?void 0:n.totals)==null?void 0:l.emails_delivered)||0,trend:((y=(c=e.campaignBMetrics)==null?void 0:c.trends)==null?void 0:y.delivery_rate)||0,icon:"ri-mail-send-line",color:"primary"},null,8,["value","trend"]),t(f,{title:"Entries",value:((w=(B=e.campaignBMetrics)==null?void 0:B.totals)==null?void 0:w.entries)||0,trend:((D=(S=e.campaignBMetrics)==null?void 0:S.trends)==null?void 0:D.entry_rate)||0,icon:"ri-user-add-line",color:"success"},null,8,["value","trend"]),t(f,{title:"Leads",value:((x=(M=e.campaignBMetrics)==null?void 0:M.totals)==null?void 0:x.leads)||0,trend:((A=(k=e.campaignBMetrics)==null?void 0:k.trends)==null?void 0:A.lead_rate)||0,icon:"ri-team-line",color:"warning"},null,8,["value","trend"]),t(f,{title:"Conversion Rate",value:((F=(T=e.campaignBMetrics)==null?void 0:T.rates)==null?void 0:F.conversion_rate)||0,trend:((L=(P=e.campaignBMetrics)==null?void 0:P.trends)==null?void 0:L.conversion_trend)||0,suffix:"%",icon:"ri-percent-line",color:"info"},null,8,["value","trend"])]}),_:1})])]),_:1}),t(m,{xxl:"4",lg:"12",cols:"12"},{default:i(()=>[t(ee,{"selected-campaigns":e.selectedCampaigns,"campaign-a-metrics":e.campaignAMetrics,"campaign-b-metrics":e.campaignBMetrics},null,8,["selected-campaigns","campaign-a-metrics","campaign-b-metrics"])]),_:1})]),_:1}),t(g,null,{default:i(()=>[t(m,{lg:"12"},{default:i(()=>[t(ae,{"campaign-a-metrics":e.campaignAMetrics,"campaign-b-metrics":e.campaignBMetrics,"selected-campaigns":e.selectedCampaigns},null,8,["campaign-a-metrics","campaign-b-metrics","selected-campaigns"])]),_:1})]),_:1}),t(g,null,{default:i(()=>[t(m,{xl:"6",md:"6"},{default:i(()=>[t(te,{"all-campaign-metrics":e.allCampaignMetrics},null,8,["all-campaign-metrics"])]),_:1}),t(m,{xl:"6",md:"6"},{default:i(()=>[t(ie,{"campaign-a-metrics":e.campaignAMetrics,"campaign-b-metrics":e.campaignBMetrics,"selected-campaigns":e.selectedCampaigns},null,8,["campaign-a-metrics","campaign-b-metrics","selected-campaigns"])]),_:1})]),_:1})]),_:1})}const Sa=Te(Fe,[["render",Ue]]);export{Sa as default};
