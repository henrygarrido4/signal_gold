import{T as L,b as y,r as T,c as x,w as n,o as f,d as b,f as o,a,l as g,C as P,D as q,h as p,k,e as v,t as A,u as s,n as _,j as R,B as z}from"./app-BWABJYdq.js";import{_ as O}from"./FormSection-DSfVi5rz.js";import{_ as w}from"./InputError-B_c1H38P.js";import{_ as h}from"./InputLabel-Kyj4220J.js";import{_ as S}from"./TextInput-BBuMCo87.js";import{S as N}from"./sweetalert2.esm.all-CumHaNCI.js";const M={key:0,class:"mb-3"},Y={class:"mb-2"},G={class:"mb-2"},H=["src","alt"],J={class:"text-danger mt-2"},K={class:"mb-3"},Q={class:"row"},W={class:"col-md-6"},X={class:"col-md-6"},Z={class:"mb-3"},ee={key:0},te={class:"text-sm mt-2 text-muted"},se={class:"alert alert-success text-success"},oe={key:0,class:"alert alert-info mt-3"},ue={__name:"UpdateProfileInformationForm",props:{user:Object},setup(m){const i=m,V=i.user.name?i.user.name.split(" "):["",""],$=i.user.first_name||V[0]||"",F=i.user.last_name||V.slice(1).join(" ")||"",e=L({_method:"PUT",name:i.user.name,email:i.user.email,first_name:$,last_name:F,photo:null}),B=y(null),u=y(null),l=y(null),I=()=>{l.value&&(e.photo=l.value.files[0]),e.name=`${e.first_name} ${e.last_name}`.trim(),e.post(route("user-profile-information.update"),{errorBag:"updateProfileInformation",preserveScroll:!0,onSuccess:()=>{C(),N.fire({title:"Success!",text:"Profile information updated successfully.",icon:"success",showConfirmButton:!1,timer:1500,timerProgressBar:!0})},onError:r=>{console.error("Profile update error:",r),N.fire({icon:"error",title:"Error",text:"Failed to update profile information.",confirmButtonText:"Ok"})}})},U=()=>{B.value=!0},E=()=>{l.value.click()},j=()=>{const r=l.value.files[0];if(!r)return;const t=new FileReader;t.onload=d=>{u.value=d.target.result},t.readAsDataURL(r)},D=()=>{z.delete(route("current-user-photo.destroy"),{preserveScroll:!0,onSuccess:()=>{u.value=null,C()}})},C=()=>{var r;(r=l.value)!=null&&r.value&&(l.value.value=null)};return(r,t)=>{const d=T("BButton");return f(),x(O,{onSubmitted:I,title:"Profile Information",description:"Update your account's profile information and email address."},{form:n(()=>[r.$page.props.jetstream.managesProfilePhotos?(f(),b("div",M,[o("div",Y,[o("input",{ref_key:"photoInput",ref:l,type:"file",class:"d-none form-control",onChange:j},null,544),a(h,{for:"photo",value:"Photo"})]),o("div",G,[g(o("div",null,[o("img",{src:m.user.profile_photo_url,alt:m.user.name,class:"rounded-circle",width:"100"},null,8,H)],512),[[P,!u.value]]),g(o("div",null,[o("span",{class:"d-block rounded-circle w-25",style:q("background-image: url('"+u.value+"');")},null,4)],512),[[P,u.value]])]),a(d,{variant:"primary",class:"me-2 btn-sm",type:"button",onClick:k(E,["prevent"])},{default:n(()=>t[3]||(t[3]=[p("Select A New Photo")])),_:1}),m.user.profile_photo_path?(f(),x(d,{key:0,variant:"danger",type:"button",class:"btn-sm",onClick:k(D,["prevent"])},{default:n(()=>t[4]||(t[4]=[p("Remove Photo")])),_:1})):v("",!0),o("div",J,[o("span",null,A(s(e).errors.photo),1)])])):v("",!0),o("div",K,[o("div",Q,[o("div",W,[a(h,{for:"first_name",value:"First Name"}),a(S,{id:"first_name",modelValue:s(e).first_name,"onUpdate:modelValue":t[0]||(t[0]=c=>s(e).first_name=c),type:"text",required:"",class:_({"is-invalid":s(e).errors.first_name})},null,8,["modelValue","class"]),a(w,{message:s(e).errors.first_name,class:"mt-2"},null,8,["message"])]),o("div",X,[a(h,{for:"last_name",value:"Last Name"}),a(S,{id:"last_name",modelValue:s(e).last_name,"onUpdate:modelValue":t[1]||(t[1]=c=>s(e).last_name=c),type:"text",required:"",class:_({"is-invalid":s(e).errors.last_name})},null,8,["modelValue","class"]),a(w,{message:s(e).errors.last_name,class:"mt-2"},null,8,["message"])])])]),o("div",Z,[a(h,{for:"email",value:"Email"}),a(S,{id:"email",modelValue:s(e).email,"onUpdate:modelValue":t[2]||(t[2]=c=>s(e).email=c),type:"email",required:"",autocomplete:"username",class:_({"is-invalid":s(e).errors.email})},null,8,["modelValue","class"]),a(w,{message:s(e).errors.email,class:"mt-2"},null,8,["message"]),r.$page.props.jetstream.hasEmailVerification&&m.user.email_verified_at===null?(f(),b("div",ee,[o("p",te,[t[6]||(t[6]=p(" Your email address is unverified. ")),a(s(R),{href:r.route("verification.send"),method:"post",as:"button",class:"btn btn-sm btn-warning",onClick:k(U,["prevent"])},{default:n(()=>t[5]||(t[5]=[p(" Click here to re-send the verification email. ")])),_:1},8,["href"])]),g(o("div",se," A new verification link has been sent to your email address. ",512),[[P,B.value]])])):v("",!0)])]),actions:n(()=>[a(d,{variant:"primary w-100",type:"submit",class:_({"opacity-25":s(e).processing}),disabled:s(e).processing},{default:n(()=>t[7]||(t[7]=[p("Save")])),_:1},8,["class","disabled"]),s(e).recentlySuccessful?(f(),b("p",oe,"Profile Saved.")):v("",!0)]),_:1})}}};export{ue as default};
